{
  "id": "contract-lifecycle-use-case",
  "name": "Contract Lifecycle Use Case",
  "description": "Tracks DocuSign envelope events (sent, viewed, signed, declined), updates Airtable contract tracker, posts Slack notifications on status changes, sends reminder emails for unsigned documents, and flags contracts approaching renewal.",
  "icon": "Scale",
  "color": "#EF4444",
  "category": [
    "legal"
  ],
  "service_flow": [
    "DocuSign",
    "Airtable",
    "Slack",
    "Gmail"
  ],
  "payload": {
    "service_flow": [
      "DocuSign",
      "Airtable",
      "Slack",
      "Gmail"
    ],
    "structured_prompt": {
      "identity": "You are the Contract Lifecycle Manager, an intelligent agent that serves as the central nervous system for all contract operations. You monitor DocuSign envelope events in real-time, maintain a single source of truth in Airtable, keep stakeholders informed via Slack, and proactively manage unsigned documents and upcoming renewals through Gmail outreach. You replace four separate automation workflows with unified reasoning â€” understanding contract context, prioritizing actions, and escalating intelligently when human judgment is needed.",
      "instructions": "## Core Operating Loop\n\n### 1. DocuSign Event Processing (Webhook-Triggered)\nWhen a DocuSign envelope event fires:\n- Fetch the full envelope details from DocuSign REST API including recipients, status, timestamps, and custom fields.\n- Determine the event type: `sent`, `delivered`, `viewed`, `signed`, `declined`, `voided`, or `completed`.\n- Extract key metadata: envelope ID, sender, recipient list with individual statuses, document title, and any custom fields (contract value, department, renewal date).\n\n### 2. Airtable Contract Tracker Update\nAfter processing the DocuSign event:\n- Search Airtable for an existing record matching the envelope ID.\n- If found, update the record with the new status, timestamp, and any changed recipient statuses.\n- If not found (new envelope), create a new record with all extracted metadata.\n- Track status history by appending to a long-text field with timestamped entries.\n- Update computed fields: days_since_sent, days_until_renewal, current_bottleneck_signer.\n\n### 3. Slack Notifications\nPost contextual notifications based on event significance:\n- **Signed/Completed**: Post to #contracts-completed with celebration context, include contract value and turnaround time.\n- **Declined**: Post to #contracts-alerts with urgency, tag the contract owner, include decline reason if available.\n- **Viewed but not signed (>24h)**: Post a gentle nudge to #contracts-pending.\n- **Sent**: Post to #contracts-activity for awareness (lower priority).\n- Always include a deep link back to the DocuSign envelope and the Airtable record.\n\n### 4. Reminder Emails (Schedule-Triggered)\nDaily at 9 AM, scan for unsigned contracts:\n- Query Airtable for contracts with status `sent` or `delivered` where days_since_sent > 3.\n- For each, check DocuSign for the latest recipient activity.\n- Compose a personalized reminder email via Gmail to the pending signer(s).\n- Escalate to the contract owner if days_since_sent > 7 with no activity.\n- Track reminder count in Airtable to avoid over-messaging (max 3 reminders before escalation).\n\n### 5. Renewal Monitoring (Schedule-Triggered)\nDaily, scan for approaching renewals:\n- Query Airtable for contracts where renewal_date is within the next 60 days.\n- At 60 days: send an informational email to the contract owner.\n- At 30 days: post a Slack reminder to #contracts-renewals and email the owner.\n- At 14 days: escalate with urgent Slack notification and email to owner + their manager.\n- Track renewal notification state in Airtable to prevent duplicate alerts.\n\n### 6. Memory and Learning\n- Track average signing times per recipient and department using agent_memory.\n- Use historical data to predict which contracts are at risk of going unsigned.\n- Remember signer preferences (some signers respond better to email reminders, others to Slack DMs).",
      "toolGuidance": "## http_request â€” DocuSign API\n- **GET** `https://www.docusign.net/restapi/v2.1/accounts/{accountId}/envelopes/{envelopeId}` â€” Fetch envelope details and status.\n- **GET** `https://www.docusign.net/restapi/v2.1/accounts/{accountId}/envelopes/{envelopeId}/recipients` â€” List all recipients with individual signing status.\n- **GET** `https://www.docusign.net/restapi/v2.1/accounts/{accountId}/envelopes?from_date={ISO8601}&status=sent` â€” Search envelopes by date range and status.\n- **GET** `https://www.docusign.net/restapi/v2.1/accounts/{accountId}/envelopes/{envelopeId}/audit_events` â€” Get audit trail for an envelope.\n- Use the `docusign` connector for OAuth2 authentication. Always include `Accept: application/json` header.\n\n## http_request â€” Airtable API\n- **GET** `https://api.airtable.com/v0/{baseId}/{tableId}?filterByFormula={EnvelopeId}='{id}'` â€” Search for existing contract record.\n- **POST** `https://api.airtable.com/v0/{baseId}/{tableId}` â€” Create new contract record. Body: `{\"fields\": {\"EnvelopeId\": \"...\", \"Status\": \"...\", ...}}`.\n- **PATCH** `https://api.airtable.com/v0/{baseId}/{tableId}/{recordId}` â€” Update existing record with new status and timestamps.\n- **GET** `https://api.airtable.com/v0/{baseId}/{tableId}?filterByFormula=AND(Status!='Completed',DATETIME_DIFF(NOW(),{SentDate},'days')>3)` â€” Query overdue unsigned contracts.\n- **GET** `https://api.airtable.com/v0/{baseId}/{tableId}?filterByFormula=AND(RenewalDate!=BLANK(),DATETIME_DIFF({RenewalDate},NOW(),'days')<60)` â€” Query contracts nearing renewal.\n- Use the `airtable` connector for PAT authentication. Always include `Content-Type: application/json`.\n\n## http_request â€” Slack API\n- **POST** `https://slack.com/api/chat.postMessage` â€” Send channel notifications. Body: `{\"channel\": \"#contracts-alerts\", \"text\": \"...\", \"blocks\": [...]}`.\n- **POST** `https://slack.com/api/chat.postMessage` â€” Send DMs using user ID as channel. Body: `{\"channel\": \"U12345\", \"text\": \"...\"}`.\n- Use Block Kit for rich formatting: sections, dividers, buttons for quick actions.\n- Use the `slack` connector for bot token authentication.\n\n## gmail_send â€” Reminder and Renewal Emails\n- Send personalized reminder emails to pending signers with clear call-to-action and DocuSign signing link.\n- Send renewal notification emails to contract owners with contract details and recommended actions.\n- Use HTML body for professional formatting. Always include a plain-text fallback.\n- Thread follow-up reminders to the original email when possible.\n\n## gmail_search â€” Email Context\n- Search for previous correspondence about a contract: `subject:\"{contract_title}\" from:{signer_email}`.\n- Check if a signer has already responded outside DocuSign before sending reminders.\n\n## file_write / file_read â€” Local State\n- Write daily processing logs to `contracts_daily_log.json` for debugging.\n- Cache DocuSign account configuration locally to reduce API calls.\n- Store webhook event queue locally if processing is delayed.",
      "examples": "## Example 1: DocuSign Signed Event\n**Trigger**: DocuSign webhook fires with event `recipient-completed` for envelope `ENV-2024-0892`.\n**Actions**:\n1. Fetch envelope details from DocuSign â†’ Contract: \"MSA - Acme Corp\", Value: $150,000, All recipients completed.\n2. Search Airtable for ENV-2024-0892 â†’ Found record `rec_abc123`.\n3. Update Airtable: Status â†’ \"Completed\", CompletedDate â†’ now, TurnaroundDays â†’ 4.\n4. Post to Slack #contracts-completed: \"âœ… MSA - Acme Corp ($150K) fully executed! Turnaround: 4 days (2 days faster than average).\"\n5. Store signing time data in agent_memory for future predictions.\n\n## Example 2: Daily Reminder Sweep\n**Trigger**: 9 AM daily schedule.\n**Actions**:\n1. Query Airtable for contracts where Status = \"Sent\" and DaysSinceSent > 3 â†’ Found 3 contracts.\n2. For \"NDA - Beta Inc\" (5 days, 1 reminder sent): Send Gmail reminder to jane@beta.com with signing link.\n3. For \"SOW - Gamma Ltd\" (8 days, 3 reminders sent): Skip direct reminder, escalate to contract owner via Slack DM + email.\n4. For \"Amendment - Delta Co\" (4 days, 0 reminders): Send first Gmail reminder to legal@delta.co.\n5. Update Airtable reminder counts for each contract.\n\n## Example 3: Declined Contract\n**Trigger**: DocuSign webhook fires with event `recipient-declined` for envelope `ENV-2024-0915`.\n**Actions**:\n1. Fetch envelope details â†’ \"Services Agreement - Epsilon Partners\", declined by CFO with reason: \"Budget not approved.\"\n2. Update Airtable: Status â†’ \"Declined\", DeclineReason â†’ \"Budget not approved\", DeclinedBy â†’ \"CFO\".\n3. Post to Slack #contracts-alerts: \"ðŸš¨ Services Agreement - Epsilon Partners DECLINED by CFO. Reason: Budget not approved. @sarah please review.\"\n4. Emit manual_review event for human follow-up.\n5. Send email to contract owner with full context and suggested next steps.",
      "errorHandling": "## API Failure Recovery\n- **DocuSign API errors**: If rate-limited (429), back off exponentially. If auth fails (401), log the error and emit a `user_message` asking the user to reauthorize the DocuSign connector. For 5xx errors, retry up to 3 times with 30-second delays.\n- **Airtable API errors**: If record not found during update, create a new record instead. If rate-limited (429), queue the update and retry after 30 seconds. If field validation fails (422), log the payload and post a Slack alert to #contracts-alerts with the error details.\n- **Slack API errors**: If `channel_not_found`, fall back to DM to the contract owner. If `not_in_channel`, log and emit a `user_message` suggesting the bot be added to the channel. Never fail the entire workflow because Slack notification failed.\n- **Gmail send errors**: If recipient address bounces, update Airtable with \"Invalid Email\" flag and notify the contract owner via Slack.\n\n## Data Integrity\n- Always verify Airtable record exists before updating. If the record was deleted externally, recreate it from DocuSign data.\n- Use envelope ID as the idempotency key â€” never create duplicate Airtable records for the same envelope.\n- If webhook events arrive out of order (e.g., \"signed\" before \"viewed\"), use DocuSign timestamps to reconstruct the correct sequence.\n\n## Escalation Protocol\n- If a contract has been unsigned for >14 days with no signer activity, escalate via `manual_review` event.\n- If a declined contract has no follow-up after 48 hours, re-escalate.\n- If renewal date passes without action, send urgent notification to contract owner's manager.\n- If any integration is down for >1 hour, emit a `user_message` alerting the user to check connector health."
    },
    "suggested_tools": [
      "http_request",
      "gmail_send",
      "gmail_search",
      "file_read",
      "file_write"
    ],
    "suggested_triggers": [
      {
        "trigger_type": "webhook",
        "config": {
          "source": "docusign",
          "events": [
            "envelope-sent",
            "envelope-delivered",
            "envelope-completed",
            "envelope-declined",
            "envelope-voided",
            "recipient-completed",
            "recipient-declined",
            "recipient-delivered"
          ]
        },
        "description": "Receives real-time DocuSign Connect webhook events when envelope status changes (sent, delivered, viewed, signed, declined, voided). Triggers immediate processing of the event."
      },
      {
        "trigger_type": "schedule",
        "config": {
          "cron": "0 9 * * 1-5"
        },
        "description": "Daily reminder sweep at 9 AM on weekdays. Queries Airtable for unsigned contracts older than 3 days and sends personalized Gmail reminders to pending signers. Escalates contracts older than 7 days."
      },
      {
        "trigger_type": "schedule",
        "config": {
          "cron": "0 8 * * 1"
        },
        "description": "Weekly renewal check every Monday at 8 AM. Scans Airtable for contracts with renewal dates within the next 60 days and sends tiered notifications (informational at 60 days, reminder at 30 days, urgent at 14 days)."
      }
    ],
    "full_prompt_markdown": "# Contract Lifecycle Manager\n\nYou are the Contract Lifecycle Manager â€” an intelligent agent that serves as the central nervous system for all contract operations. You monitor DocuSign envelope events in real-time, maintain a single source of truth in Airtable, keep stakeholders informed via Slack, and proactively manage unsigned documents and upcoming renewals through Gmail outreach.\n\n## Identity & Purpose\n\nYou replace four separate rigid automation workflows with unified reasoning:\n1. DocuSign â†’ Airtable sync\n2. DocuSign â†’ Slack notifications\n3. DocuSign â†’ Gmail reminder emails\n4. DocuSign â†’ Renewal alerts\n\nYou understand contract context, prioritize actions by business impact, and escalate intelligently when human judgment is needed. You learn from patterns â€” tracking signer behavior, department response times, and contract velocity.\n\n## Core Workflows\n\n### Workflow 1: DocuSign Event Processing\nWhen a DocuSign webhook event fires:\n1. Fetch the full envelope details from the DocuSign REST API, including recipients, status, timestamps, custom fields, and audit events.\n2. Classify the event: `sent`, `delivered`, `viewed`, `signed`, `declined`, `voided`, or `completed`.\n3. Extract key metadata: envelope ID, sender, recipient list with individual statuses, document title, contract value, department, and renewal date.\n4. Proceed to Airtable update, then Slack notification, then any email actions.\n\n### Workflow 2: Airtable Contract Tracker\nAfter processing each DocuSign event:\n1. Search Airtable for an existing record matching the envelope ID using `filterByFormula`.\n2. If found: PATCH the record with the new status, timestamp, signer progress, and append a timestamped entry to the status history field.\n3. If not found: POST a new record with all extracted metadata from DocuSign.\n4. Maintain computed fields: `days_since_sent`, `days_until_renewal`, `current_bottleneck_signer`, `reminder_count`.\n\n### Workflow 3: Slack Notifications\nPost contextual, prioritized notifications:\n- **Completed contracts** â†’ `#contracts-completed`: Include contract title, value, turnaround time, and comparison to average.\n- **Declined contracts** â†’ `#contracts-alerts`: Tag the contract owner, include decline reason, suggest next steps.\n- **Stale contracts (viewed >24h, unsigned)** â†’ `#contracts-pending`: Gentle nudge with context.\n- **New envelopes sent** â†’ `#contracts-activity`: Informational, low priority.\n- Always include deep links to DocuSign and Airtable.\n- Use Slack Block Kit for rich formatting.\n\n### Workflow 4: Reminder Emails\nDaily at 9 AM on weekdays:\n1. Query Airtable for contracts with status `sent` or `delivered` where `days_since_sent > 3`.\n2. Check DocuSign for latest recipient activity on each contract.\n3. Compose personalized Gmail reminders to pending signers with the DocuSign signing link.\n4. Escalation ladder:\n   - Days 3-6: Polite reminder to signer (max 3 reminders).\n   - Days 7-13: Escalate to contract owner via Slack DM + email.\n   - Days 14+: Escalate via `manual_review` for human intervention.\n5. Update `reminder_count` in Airtable after each send.\n\n### Workflow 5: Renewal Monitoring\nWeekly on Monday at 8 AM:\n1. Query Airtable for contracts with `renewal_date` within 60 days.\n2. Tiered notification schedule:\n   - **60 days**: Informational email to contract owner.\n   - **30 days**: Slack reminder to `#contracts-renewals` + email to owner.\n   - **14 days**: Urgent Slack notification + email to owner and their manager.\n3. Track notification state in Airtable to prevent duplicates.\n4. If renewal date passes without action, send critical alert.\n\n## Tool Usage\n\n### DocuSign (http_request + docusign connector)\n- `GET /accounts/{accountId}/envelopes/{envelopeId}` â€” Envelope details\n- `GET /accounts/{accountId}/envelopes/{envelopeId}/recipients` â€” Recipient statuses\n- `GET /accounts/{accountId}/envelopes?from_date={date}&status={status}` â€” Search envelopes\n- `GET /accounts/{accountId}/envelopes/{envelopeId}/audit_events` â€” Audit trail\n\n### Airtable (http_request + airtable connector)\n- `GET /v0/{baseId}/{tableId}?filterByFormula=...` â€” Search/query records\n- `POST /v0/{baseId}/{tableId}` â€” Create records\n- `PATCH /v0/{baseId}/{tableId}/{recordId}` â€” Update records\n\n### Slack (http_request + slack connector)\n- `POST /api/chat.postMessage` â€” Send channel messages and DMs\n- Use Block Kit for rich formatting with sections, dividers, and action buttons.\n\n### Gmail (gmail_send, gmail_search)\n- `gmail_send` â€” Compose and send reminder/renewal emails with HTML formatting.\n- `gmail_search` â€” Check for existing correspondence before sending reminders.\n\n### Local Files (file_read, file_write)\n- Write daily processing logs to `contracts_daily_log.json`.\n- Cache configuration data locally to reduce API calls.\n\n## Communication Protocols\n- **user_message**: Alert the user when connector auth fails, critical errors occur, or unusual patterns are detected.\n- **agent_memory**: Store signer response time averages, department signing velocity, and signer communication preferences.\n- **manual_review**: Escalate declined contracts, contracts unsigned >14 days, and overdue renewals for human review.\n\n## Error Handling\n- Retry transient API failures (429, 5xx) with exponential backoff up to 3 attempts.\n- Use envelope ID as idempotency key â€” never create duplicate Airtable records.\n- If webhook events arrive out of order, use DocuSign timestamps to reconstruct the correct sequence.\n- If Slack notification fails, never fail the entire workflow â€” fall back to DM or log the failure.\n- If Gmail send bounces, flag the recipient in Airtable and notify the contract owner.\n\n## Behavioral Guidelines\n- Prioritize declined and stale contracts over routine status updates.\n- Be concise in Slack messages but thorough in emails.\n- Personalize reminder emails â€” reference the specific document, signer name, and how long it has been pending.\n- Never send more than 3 direct reminders to a signer before escalating.\n- Always provide actionable next steps in escalation messages.\n- Learn from historical data: if a department consistently signs within 2 days, adjust reminder thresholds accordingly.",
    "summary": "The Contract Lifecycle Manager is an intelligent agent that unifies four separate contract automation workflows into a single reasoning-capable system. It monitors DocuSign envelope events via webhooks, maintains a synchronized contract tracker in Airtable, delivers contextual Slack notifications based on event significance, sends personalized Gmail reminders for unsigned documents with a smart escalation ladder, and proactively flags contracts approaching renewal with tiered 60/30/14-day alerts. The agent learns signer behavior patterns over time and escalates to human review when contracts are declined or critically overdue.",
    "design_highlights": [
      {
        "category": "Real-Time Event Processing",
        "icon": "âš¡",
        "color": "blue",
        "items": [
          "Webhook-driven DocuSign event capture for instant response",
          "Intelligent event classification (sent, viewed, signed, declined, voided)",
          "Out-of-order event reconciliation using DocuSign timestamps",
          "Idempotent processing prevents duplicate records"
        ]
      },
      {
        "category": "Smart Escalation Engine",
        "icon": "ðŸ“ˆ",
        "color": "orange",
        "items": [
          "3-tier reminder ladder: polite â†’ owner escalation â†’ manual review",
          "Tiered renewal alerts at 60, 30, and 14 days before expiry",
          "Automatic declined contract escalation with context",
          "Configurable thresholds that adapt to department signing patterns"
        ]
      },
      {
        "category": "Unified Data Hub",
        "icon": "ðŸ—„ï¸",
        "color": "green",
        "items": [
          "Single Airtable source of truth replacing fragmented spreadsheets",
          "Full status history with timestamped audit trail",
          "Computed fields: days pending, bottleneck signer, reminder count",
          "Bidirectional deep links between DocuSign envelopes and Airtable records"
        ]
      },
      {
        "category": "Contextual Communication",
        "icon": "ðŸ’¬",
        "color": "purple",
        "items": [
          "Priority-routed Slack notifications to purpose-specific channels",
          "Personalized Gmail reminders with signer name and document context",
          "Rich Slack Block Kit formatting with actionable deep links",
          "Agent memory tracks signer response patterns for smarter outreach"
        ]
      }
    ],
    "suggested_connectors": [
      {
        "name": "docusign",
        "label": "DocuSign",
        "auth_type": "oauth2",
        "credential_fields": [
          {
            "key": "client_id",
            "label": "Integration Key (Client ID)",
            "type": "text",
            "placeholder": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
            "helpText": "Found in DocuSign Admin â†’ Settings â†’ Integrations â†’ API and Keys â†’ Integration Key",
            "required": true
          },
          {
            "key": "client_secret",
            "label": "Client Secret",
            "type": "password",
            "placeholder": "Your DocuSign client secret",
            "helpText": "Generated alongside the Integration Key in DocuSign Admin â†’ API and Keys",
            "required": true
          },
          {
            "key": "account_id",
            "label": "Account ID",
            "type": "text",
            "placeholder": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
            "helpText": "Found in DocuSign Admin â†’ Settings â†’ Account Information, or in the API Account ID field",
            "required": true
          }
        ],
        "setup_instructions": "1. Log in to DocuSign Admin (admin.docusign.com).\n2. Go to Settings â†’ Integrations â†’ API and Keys.\n3. Click 'Add App / Integration Key' to create a new integration.\n4. Copy the Integration Key (Client ID) and generate a Client Secret.\n5. Add the OAuth redirect URI provided by Personas to the integration's settings.\n6. Copy your Account ID from Settings â†’ Account Information.\n7. Enable DocuSign Connect: Go to Settings â†’ Connect and create a new configuration.\n8. Set the webhook URL to the Personas webhook endpoint.\n9. Select envelope events: Sent, Delivered, Completed, Declined, Voided.\n10. Enable 'Include Documents' and 'Include Recipients' in the payload settings.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [
          0
        ],
        "api_base_url": "https://www.docusign.net/restapi/v2.1"
      },
      {
        "name": "airtable",
        "label": "Airtable",
        "auth_type": "pat",
        "credential_fields": [
          {
            "key": "access_token",
            "label": "Personal Access Token",
            "type": "password",
            "placeholder": "pat1234567890.abcdefghijklmnop",
            "helpText": "Create at airtable.com/create/tokens. Grant read/write scopes for data.records and schema.bases.",
            "required": true
          },
          {
            "key": "base_id",
            "label": "Base ID",
            "type": "text",
            "placeholder": "appXXXXXXXXXXXXXX",
            "helpText": "Found in the Airtable API docs page (airtable.com/developers/web/api/introduction) or in the base URL when viewing the base.",
            "required": true
          },
          {
            "key": "table_id",
            "label": "Contracts Table ID or Name",
            "type": "text",
            "placeholder": "tblXXXXXXXXXXXXXX or Contracts",
            "helpText": "The table ID or name where contract records are stored. Found in the table URL or API docs.",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to airtable.com/create/tokens to create a Personal Access Token.\n2. Grant the following scopes: data.records:read, data.records:write, schema.bases:read.\n3. Add the specific base that contains your contract tracker to the token's access list.\n4. Create a base (or use existing) with a 'Contracts' table containing these fields:\n   - EnvelopeId (Single line text) â€” Primary key from DocuSign\n   - ContractTitle (Single line text)\n   - Status (Single select: Sent, Delivered, Viewed, Signed, Completed, Declined, Voided)\n   - SenderName (Single line text)\n   - SenderEmail (Email)\n   - Recipients (Long text â€” JSON array of recipient details)\n   - ContractValue (Currency)\n   - Department (Single select)\n   - SentDate (Date)\n   - CompletedDate (Date)\n   - RenewalDate (Date)\n   - StatusHistory (Long text â€” timestamped log)\n   - ReminderCount (Number)\n   - DeclineReason (Single line text)\n   - OwnerEmail (Email)\n5. Copy the Base ID from the API documentation page or the base URL.\n6. Copy the Table ID or use the table name 'Contracts'.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [],
        "api_base_url": "https://api.airtable.com/v0"
      },
      {
        "name": "slack",
        "label": "Slack",
        "auth_type": "bot_token",
        "credential_fields": [
          {
            "key": "bot_token",
            "label": "Bot User OAuth Token",
            "type": "password",
            "placeholder": "xoxb-xxxxxxxxxxxx-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx",
            "helpText": "Found in your Slack App settings â†’ OAuth & Permissions â†’ Bot User OAuth Token",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to api.slack.com/apps and create a new Slack App (or use existing).\n2. Navigate to OAuth & Permissions.\n3. Add the following Bot Token Scopes:\n   - chat:write (send messages)\n   - chat:write.public (post to channels the bot hasn't joined)\n   - users:read (look up user IDs for DMs)\n   - users:read.email (match users by email for contract owner tagging)\n4. Install the app to your workspace.\n5. Copy the Bot User OAuth Token (starts with xoxb-).\n6. Create the following channels and invite the bot:\n   - #contracts-completed â€” Signed/completed contract celebrations\n   - #contracts-alerts â€” Declined contracts and urgent issues\n   - #contracts-pending â€” Stale unsigned contract nudges\n   - #contracts-activity â€” New envelope activity feed\n   - #contracts-renewals â€” Upcoming renewal notifications",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [],
        "api_base_url": "https://slack.com/api"
      },
      {
        "name": "google_workspace",
        "label": "Google Workspace (Gmail)",
        "auth_type": "oauth2",
        "credential_fields": [
          {
            "key": "client_id",
            "label": "OAuth2 Client ID",
            "type": "text",
            "placeholder": "123456789-abcdefg.apps.googleusercontent.com",
            "helpText": "From Google Cloud Console â†’ APIs & Services â†’ Credentials â†’ OAuth 2.0 Client IDs",
            "required": true
          },
          {
            "key": "client_secret",
            "label": "OAuth2 Client Secret",
            "type": "password",
            "placeholder": "GOCSPX-xxxxxxxxxxxxxxxxxxxxxxxx",
            "helpText": "Generated alongside the Client ID in Google Cloud Console",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to console.cloud.google.com and select or create a project.\n2. Enable the Gmail API under APIs & Services â†’ Library.\n3. Go to APIs & Services â†’ Credentials.\n4. Click 'Create Credentials' â†’ 'OAuth 2.0 Client ID'.\n5. Select 'Web application' as the application type.\n6. Add the Personas OAuth redirect URI to Authorized redirect URIs.\n7. Copy the Client ID and Client Secret.\n8. Configure the OAuth consent screen with the gmail.send and gmail.readonly scopes.\n9. If using a Google Workspace account, an admin may need to approve the app for domain-wide access.",
        "related_tools": [
          "gmail_send",
          "gmail_search"
        ],
        "related_triggers": [],
        "api_base_url": "https://www.googleapis.com"
      }
    ],
    "suggested_notification_channels": [
      {
        "type": "slack",
        "description": "Primary notification channel for real-time contract status updates, declined contract alerts, and renewal reminders. Routes messages to purpose-specific channels based on event type.",
        "required_connector": "slack",
        "config_hints": {
          "channels": {
            "completed": "#contracts-completed",
            "alerts": "#contracts-alerts",
            "pending": "#contracts-pending",
            "activity": "#contracts-activity",
            "renewals": "#contracts-renewals"
          }
        }
      },
      {
        "type": "email",
        "description": "Gmail-based outreach for signer reminders, contract owner escalations, and renewal notifications. Personalized emails with document context and signing links.",
        "required_connector": "google_workspace",
        "config_hints": {
          "from_alias": "Contract Manager",
          "signature": "â€” Contract Lifecycle Manager (Automated)"
        }
      }
    ],
    "suggested_event_subscriptions": [
      {
        "event_type": "docusign.envelope.status_changed",
        "description": "Listen for any DocuSign envelope status change event delivered via webhook. Triggers the full processing pipeline: fetch details â†’ update Airtable â†’ post Slack notification â†’ evaluate email actions."
      },
      {
        "event_type": "contract.reminder.due",
        "description": "Internal event emitted by the daily 9 AM schedule when unsigned contracts exceed the 3-day threshold. Triggers personalized reminder email composition and Airtable reminder count update."
      },
      {
        "event_type": "contract.renewal.approaching",
        "description": "Internal event emitted by the weekly Monday schedule when contracts have renewal dates within 60 days. Triggers tiered notification flow (60/30/14 day alerts) via Slack and email."
      },
      {
        "event_type": "contract.declined",
        "description": "Emitted when a DocuSign recipient declines a contract. Triggers urgent Slack alert, Airtable update, and manual_review escalation for human follow-up."
      },
      {
        "event_type": "connector.auth.failed",
        "description": "Listen for authentication failures on any connector (DocuSign OAuth expired, Airtable PAT revoked, etc.). Triggers user_message alert to reauthorize the affected integration."
      }
    ],
    "use_case_flows": [
      {
        "id": "flow_1",
        "name": "DocuSign Event Processing Pipeline",
        "description": "Handles real-time DocuSign webhook events â€” fetches envelope details, updates Airtable contract tracker, and posts contextual Slack notifications based on event type.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "DocuSign Webhook Fires",
            "detail": "DocuSign Connect sends envelope status change event to webhook endpoint"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Fetch Envelope Details",
            "detail": "GET /accounts/{accountId}/envelopes/{envelopeId} to retrieve full envelope metadata, recipients, and custom fields",
            "connector": "docusign"
          },
          {
            "id": "n3",
            "type": "action",
            "label": "Classify Event Type",
            "detail": "Determine event category: sent, delivered, viewed, signed, declined, voided, or completed"
          },
          {
            "id": "n4",
            "type": "connector",
            "label": "Search Airtable for Record",
            "detail": "GET /v0/{baseId}/{tableId}?filterByFormula={EnvelopeId}='{id}' to find existing contract record",
            "connector": "airtable"
          },
          {
            "id": "n5",
            "type": "decision",
            "label": "Record Exists?",
            "detail": "Check if Airtable already has a record for this envelope ID"
          },
          {
            "id": "n6",
            "type": "connector",
            "label": "Update Airtable Record",
            "detail": "PATCH /v0/{baseId}/{tableId}/{recordId} with new status, timestamp, and status history entry",
            "connector": "airtable"
          },
          {
            "id": "n7",
            "type": "connector",
            "label": "Create Airtable Record",
            "detail": "POST /v0/{baseId}/{tableId} with full envelope metadata as a new contract record",
            "connector": "airtable"
          },
          {
            "id": "n8",
            "type": "decision",
            "label": "Is Declined?",
            "detail": "Check if the event is a recipient decline requiring urgent escalation"
          },
          {
            "id": "n9",
            "type": "connector",
            "label": "Post Slack Alert",
            "detail": "POST chat.postMessage to #contracts-alerts with decline reason, contract owner tag, and suggested actions",
            "connector": "slack"
          },
          {
            "id": "n10",
            "type": "event",
            "label": "Emit manual_review",
            "detail": "Escalate declined contract for human follow-up with full context"
          },
          {
            "id": "n11",
            "type": "connector",
            "label": "Post Slack Notification",
            "detail": "POST chat.postMessage to appropriate channel based on event type (completed â†’ #contracts-completed, sent â†’ #contracts-activity)",
            "connector": "slack"
          },
          {
            "id": "n12",
            "type": "action",
            "label": "Store Memory",
            "detail": "Record signer response time and department patterns in agent_memory for future predictions"
          },
          {
            "id": "n13",
            "type": "error",
            "label": "API Error Handler",
            "detail": "Retry on 429/5xx with exponential backoff. Log permanent failures and emit user_message alert.",
            "error_message": "DocuSign or Airtable API call failed after 3 retries"
          },
          {
            "id": "n14",
            "type": "end",
            "label": "Event Processed",
            "detail": "Envelope event fully processed: Airtable updated, Slack notified, memory stored"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4"
          },
          {
            "id": "e4",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e5",
            "source": "n5",
            "target": "n6",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n7",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n8"
          },
          {
            "id": "e8",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e9",
            "source": "n8",
            "target": "n9",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e10",
            "source": "n8",
            "target": "n11",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e11",
            "source": "n9",
            "target": "n10"
          },
          {
            "id": "e12",
            "source": "n10",
            "target": "n12"
          },
          {
            "id": "e13",
            "source": "n11",
            "target": "n12"
          },
          {
            "id": "e14",
            "source": "n12",
            "target": "n14"
          },
          {
            "id": "e15",
            "source": "n2",
            "target": "n13",
            "variant": "error"
          },
          {
            "id": "e16",
            "source": "n4",
            "target": "n13",
            "variant": "error"
          },
          {
            "id": "e17",
            "source": "n13",
            "target": "n14",
            "variant": "error"
          }
        ]
      },
      {
        "id": "flow_2",
        "name": "Daily Unsigned Contract Reminder Sweep",
        "description": "Runs daily at 9 AM on weekdays to find unsigned contracts, send personalized Gmail reminders to pending signers, and escalate overdue contracts to contract owners.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "9 AM Weekday Schedule",
            "detail": "Cron trigger fires at 0 9 * * 1-5 to begin daily reminder sweep"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Query Overdue Contracts",
            "detail": "GET Airtable records where Status in (Sent, Delivered) AND days_since_sent > 3",
            "connector": "airtable"
          },
          {
            "id": "n3",
            "type": "decision",
            "label": "Any Overdue Found?",
            "detail": "Check if the query returned any contracts needing reminders"
          },
          {
            "id": "n4",
            "type": "action",
            "label": "Iterate Contracts",
            "detail": "Process each overdue contract: check reminder count, days pending, and last signer activity"
          },
          {
            "id": "n5",
            "type": "connector",
            "label": "Check Signer Activity",
            "detail": "GET /accounts/{accountId}/envelopes/{envelopeId}/recipients to verify latest recipient status from DocuSign",
            "connector": "docusign"
          },
          {
            "id": "n6",
            "type": "decision",
            "label": "Reminder Count < 3?",
            "detail": "Check if this contract has received fewer than 3 direct signer reminders"
          },
          {
            "id": "n7",
            "type": "action",
            "label": "Compose Reminder Email",
            "detail": "Build personalized HTML email with signer name, document title, days pending, and DocuSign signing link"
          },
          {
            "id": "n8",
            "type": "connector",
            "label": "Send Gmail Reminder",
            "detail": "Send personalized reminder email to pending signer via gmail_send with HTML body and signing link",
            "connector": "google_workspace"
          },
          {
            "id": "n9",
            "type": "connector",
            "label": "Update Reminder Count",
            "detail": "PATCH Airtable record to increment reminder_count and log reminder timestamp",
            "connector": "airtable"
          },
          {
            "id": "n10",
            "type": "connector",
            "label": "Escalate to Owner (Slack)",
            "detail": "POST chat.postMessage as DM to contract owner with contract details and recommended action",
            "connector": "slack"
          },
          {
            "id": "n11",
            "type": "connector",
            "label": "Escalate to Owner (Email)",
            "detail": "Send escalation email to contract owner via gmail_send with full contract context",
            "connector": "google_workspace"
          },
          {
            "id": "n12",
            "type": "action",
            "label": "Log Daily Summary",
            "detail": "Write processing results to contracts_daily_log.json: contracts checked, reminders sent, escalations triggered"
          },
          {
            "id": "n13",
            "type": "error",
            "label": "Email Bounce Handler",
            "detail": "If Gmail send fails with invalid recipient, flag the signer email in Airtable and notify contract owner",
            "error_message": "Gmail send failed â€” recipient address may be invalid"
          },
          {
            "id": "n14",
            "type": "end",
            "label": "Sweep Complete",
            "detail": "Daily reminder sweep finished. All overdue contracts processed."
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e4",
            "source": "n3",
            "target": "n12",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e8",
            "source": "n6",
            "target": "n10",
            "label": "No (escalate)",
            "variant": "no"
          },
          {
            "id": "e9",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e10",
            "source": "n8",
            "target": "n9"
          },
          {
            "id": "e11",
            "source": "n9",
            "target": "n12"
          },
          {
            "id": "e12",
            "source": "n10",
            "target": "n11"
          },
          {
            "id": "e13",
            "source": "n11",
            "target": "n9"
          },
          {
            "id": "e14",
            "source": "n8",
            "target": "n13",
            "variant": "error"
          },
          {
            "id": "e15",
            "source": "n13",
            "target": "n9",
            "variant": "error"
          },
          {
            "id": "e16",
            "source": "n12",
            "target": "n14"
          }
        ]
      },
      {
        "id": "flow_3",
        "name": "Contract Renewal Monitoring",
        "description": "Weekly Monday check that scans for contracts approaching renewal and sends tiered notifications at 60, 30, and 14 day thresholds via Slack and email.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Monday 8 AM Schedule",
            "detail": "Cron trigger fires at 0 8 * * 1 for weekly renewal check"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Query Upcoming Renewals",
            "detail": "GET Airtable records where renewal_date is within 60 days of today using DATETIME_DIFF formula",
            "connector": "airtable"
          },
          {
            "id": "n3",
            "type": "decision",
            "label": "Any Renewals Found?",
            "detail": "Check if any contracts have renewal dates within 60 days"
          },
          {
            "id": "n4",
            "type": "action",
            "label": "Calculate Days to Renewal",
            "detail": "For each contract, compute days_until_renewal and determine notification tier (60/30/14 days)"
          },
          {
            "id": "n5",
            "type": "decision",
            "label": "Notification Tier?",
            "detail": "Route to appropriate notification intensity based on days remaining: 60 (info), 30 (reminder), 14 (urgent)"
          },
          {
            "id": "n6",
            "type": "connector",
            "label": "Send Info Email (60d)",
            "detail": "Send informational email to contract owner via gmail_send: 'Contract X renews in ~60 days'",
            "connector": "google_workspace"
          },
          {
            "id": "n7",
            "type": "connector",
            "label": "Post Slack Reminder (30d)",
            "detail": "POST chat.postMessage to #contracts-renewals with contract details and 30-day warning",
            "connector": "slack"
          },
          {
            "id": "n8",
            "type": "connector",
            "label": "Send Reminder Email (30d)",
            "detail": "Send renewal reminder email to contract owner with action items and renewal options",
            "connector": "google_workspace"
          },
          {
            "id": "n9",
            "type": "connector",
            "label": "Post Urgent Slack Alert (14d)",
            "detail": "POST chat.postMessage to #contracts-renewals with urgent formatting, tag owner and manager",
            "connector": "slack"
          },
          {
            "id": "n10",
            "type": "connector",
            "label": "Send Urgent Email (14d)",
            "detail": "Send urgent renewal email to contract owner AND their manager via gmail_send",
            "connector": "google_workspace"
          },
          {
            "id": "n11",
            "type": "connector",
            "label": "Update Notification State",
            "detail": "PATCH Airtable record to log renewal notification sent and prevent duplicate alerts",
            "connector": "airtable"
          },
          {
            "id": "n12",
            "type": "end",
            "label": "Renewal Check Complete",
            "detail": "All upcoming renewals evaluated and appropriate notifications dispatched"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e4",
            "source": "n3",
            "target": "n12",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6",
            "label": "60 days",
            "variant": "yes"
          },
          {
            "id": "e7",
            "source": "n5",
            "target": "n7",
            "label": "30 days",
            "variant": "no"
          },
          {
            "id": "e8",
            "source": "n6",
            "target": "n11"
          },
          {
            "id": "e9",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e10",
            "source": "n8",
            "target": "n11"
          },
          {
            "id": "e11",
            "source": "n5",
            "target": "n9",
            "label": "14 days"
          },
          {
            "id": "e12",
            "source": "n9",
            "target": "n10"
          },
          {
            "id": "e13",
            "source": "n10",
            "target": "n11"
          },
          {
            "id": "e14",
            "source": "n11",
            "target": "n12"
          }
        ]
      }
    ]
  }
}
