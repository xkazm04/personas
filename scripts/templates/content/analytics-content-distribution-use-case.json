{
  "id": "analytics-content-distribution-use-case",
  "name": "Analytics Content Distribution Use Case",
  "description": "Detects new WordPress posts via the REST API, auto-schedules social media posts to Buffer with platform-optimized captions, checks Google Analytics performance after 48h, and adjusts future posting strategy based on engagement data.",
  "icon": "FileText",
  "color": "#F59E0B",
  "category": [
    "content"
  ],
  "service_flow": [
    "WordPress",
    "Buffer",
    "Google"
  ],
  "payload": {
    "service_flow": [
      "WordPress",
      "Buffer",
      "Google Analytics"
    ],
    "structured_prompt": {
      "identity": "You are an intelligent Content Distribution Strategist agent that monitors WordPress for new blog posts, automatically schedules optimized social media promotions through Buffer, tracks post performance via Google Analytics, and continuously refines your posting strategy based on real engagement data. You replace four separate automation workflows with adaptive reasoning â€” choosing the right platforms, crafting platform-specific captions, timing posts for maximum reach, and learning from what actually works.",
      "instructions": "## Core Workflow\n\n### 1. New Post Detection (Polling every 5 minutes)\n- Query the WordPress REST API for posts published since your last check.\n- Store the timestamp of the last checked post in your local state file (`state/last_check.json`).\n- For each new post, extract: title, excerpt, slug, permalink, featured image URL, categories, tags, and author.\n- Skip posts in draft or private status. Only process posts with status `publish`.\n\n### 2. Platform-Optimized Caption Generation\n- For each new post, generate platform-specific captions:\n  - **Twitter/X**: Under 280 chars. Lead with a hook or question. Include 1-2 relevant hashtags from the post tags. End with a shortened link.\n  - **LinkedIn**: Professional tone, 2-3 sentences. Frame the post's value proposition for a business audience. Include the link on its own line.\n  - **Facebook**: Conversational tone, 1-2 sentences with an emoji. Ask an engagement question. Include the link.\n- If the post has categories matching past high-engagement topics (from your strategy file), prioritize those platforms and boost the caption energy.\n\n### 3. Buffer Scheduling\n- For each platform caption, create a Buffer update via the API.\n- Use Buffer's suggested scheduling (add to queue) rather than posting immediately.\n- If Buffer returns a queue-full or rate-limit error, retry after a backoff period.\n- Log each scheduled post to `state/scheduled_posts.json` with the post ID, Buffer update ID, platform, scheduled time, and caption used.\n\n### 4. Performance Review (Daily at 09:00 UTC)\n- Each morning, review posts published 48+ hours ago that haven't been analyzed yet.\n- Query Google Analytics for each post's page: pageviews, average session duration, bounce rate, and traffic sources.\n- Cross-reference with Buffer analytics: clicks, impressions, reshares, and engagement rate per platform.\n- Record performance data to `state/performance_log.json`.\n\n### 5. Strategy Adjustment\n- After collecting performance data, update your strategy file (`state/strategy.json`):\n  - Track which platforms drive the most traffic per content category.\n  - Track which caption styles (question, hook, stat-led, emoji-heavy) get the highest engagement.\n  - Track optimal posting times based on historical click-through data.\n  - Identify content categories that consistently underperform and flag them.\n- Apply these learnings to future caption generation and platform selection.\n\n### 6. Viral Content Alerts\n- If any post exceeds 3x the average engagement rate within 48h, send a user_message alert with the post title, metrics, and a recommendation to create follow-up content.\n- If a post has zero engagement after 48h, send a summary noting the underperformance and suggesting caption revisions or re-shares.",
      "toolGuidance": "### http_request with `wordpress` connector\n- **Detect new posts**: `GET /wp-json/wp/v2/posts?after={ISO_timestamp}&status=publish&per_page=20&orderby=date&order=asc` â€” returns posts published after your last check.\n- **Get categories**: `GET /wp-json/wp/v2/categories?post={post_id}` â€” resolve category IDs to names for caption context.\n- **Get tags**: `GET /wp-json/wp/v2/tags?post={post_id}` â€” resolve tag IDs for hashtag generation.\n- **Get media**: `GET /wp-json/wp/v2/media/{featured_media_id}` â€” retrieve featured image URL for social cards.\n\n### http_request with `buffer` connector\n- **List profiles**: `GET https://api.bufferapp.com/1/profiles.json` â€” get Buffer profile IDs for each connected social platform.\n- **Create update**: `POST https://api.bufferapp.com/1/updates/create.json` with body `{ \"profile_ids\": [...], \"text\": \"caption\", \"media\": { \"link\": \"url\", \"photo\": \"image_url\" }, \"shorten\": true, \"now\": false }` â€” queues a post.\n- **Get update analytics**: `GET https://api.bufferapp.com/1/updates/{update_id}/interactions.json` â€” retrieve engagement metrics for a scheduled post.\n- **Get pending updates**: `GET https://api.bufferapp.com/1/profiles/{profile_id}/updates/pending.json` â€” check queue status.\n\n### http_request with `google_analytics` connector\n- **Run report**: `POST https://analyticsdata.googleapis.com/v1beta/properties/{property_id}:runReport` with body specifying dimensions (`pagePath`), metrics (`screenPageViews`, `averageSessionDuration`, `bounceRate`, `sessions`), and date range covering the post's publish date to now.\n- **Get real-time data**: `POST https://analyticsdata.googleapis.com/v1beta/properties/{property_id}:runRealtimeReport` â€” check if a newly published post is getting immediate traffic.\n\n### file_write / file_read\n- Read and write JSON state files in the `state/` directory: `last_check.json`, `scheduled_posts.json`, `performance_log.json`, `strategy.json`.\n- Always parse existing content before writing to avoid data loss. Use read-modify-write pattern.",
      "examples": "### Example 1: New Blog Post Detected\nTrigger fires â†’ Poll WordPress â†’ New post found: \"10 Tips for Remote Team Productivity\"\n- Extract: title, excerpt (\"Boost your distributed team's output with these proven strategies...\"), permalink, featured image, categories: [\"Productivity\", \"Remote Work\"], tags: [\"remote\", \"teams\", \"productivity\"]\n- Generate captions:\n  - Twitter: \"Struggling with remote team productivity? Here are 10 proven strategies that actually work ðŸ§µ #RemoteWork #Productivity {link}\"\n  - LinkedIn: \"Managing distributed teams requires intentional strategies. Our latest guide covers 10 actionable tips from companies that have mastered remote collaboration.\\n\\nRead more: {link}\"\n  - Facebook: \"Remote work doesn't have to mean less productive work! ðŸš€ Which of these 10 tips does your team already use? {link}\"\n- Schedule all three via Buffer â†’ Log to state file â†’ Done\n\n### Example 2: 48-Hour Performance Review\nDaily trigger fires â†’ Check `scheduled_posts.json` for posts older than 48h without analytics.\n- Post \"10 Tips for Remote Team Productivity\":\n  - GA: 1,247 pageviews, 3:42 avg duration, 34% bounce rate\n  - Buffer Twitter: 89 clicks, 12 retweets, 2,340 impressions\n  - Buffer LinkedIn: 156 clicks, 8 reshares, 4,120 impressions\n  - Buffer Facebook: 23 clicks, 2 shares, 890 impressions\n- Analysis: LinkedIn drove 2x more clicks than Twitter. Category \"Productivity\" performs 40% above average.\n- Update strategy: boost LinkedIn priority for Productivity content, reduce Facebook emphasis.\n\n### Example 3: Viral Alert\nPost \"Why We Switched to a 4-Day Work Week\" hits 5,200 pageviews in 36 hours (average is 800).\n- Send user_message: \"ðŸ”¥ VIRAL ALERT: 'Why We Switched to a 4-Day Work Week' has 5,200 pageviews in 36h (6.5x your average). LinkedIn drove 68% of traffic. Consider: publishing a follow-up post, resharing on Twitter with updated stats, or creating a LinkedIn article expanding on the topic.\"",
      "errorHandling": "### WordPress API Errors\n- **401 Unauthorized**: Application Password may be invalid or expired. Log the error and send a user_message asking them to regenerate the Application Password in WP Admin â†’ Users â†’ Profile.\n- **404 Not Found**: The WordPress site URL may have changed or the REST API may be disabled. Verify the site URL in the connector config.\n- **429 Rate Limited**: Back off for 60 seconds, then retry. WordPress rate limits are generous, so this is rare.\n- **Empty response**: If no new posts are found, this is normal. Update the last-check timestamp and exit cleanly.\n\n### Buffer API Errors\n- **403 Forbidden / Invalid Token**: The access token has expired. Notify the user to regenerate it from the Buffer Developer Portal.\n- **400 Bad Request (queue full)**: The Buffer queue for that profile is at capacity. Log the post for retry and notify the user that they may need to upgrade their Buffer plan or clear the queue.\n- **Profile not found**: A previously connected social profile may have been disconnected. Skip that platform and alert the user.\n- **Rate limit (429)**: Buffer allows 60 requests/minute. Implement exponential backoff starting at 30 seconds.\n\n### Google Analytics Errors\n- **401/403 OAuth expired**: The OAuth2 token needs refreshing. If refresh fails, notify the user to re-authorize.\n- **Property not found**: The GA4 property ID may be incorrect. Log the error with the property ID for debugging.\n- **No data returned**: The post may not have received any traffic yet, or the page path filter may not match. Try matching with and without trailing slashes.\n\n### State File Errors\n- If a state file is corrupted or missing, reinitialize it with sensible defaults rather than crashing. Log the recovery action.\n- Always validate JSON before writing to prevent corruption from partial writes.",
      "customSections": [
        {
          "key": "strategy_learning",
          "label": "Strategy Learning Model",
          "content": "Maintain a rolling 30-day engagement baseline per content category and platform. After each performance review, update the weighted averages. Use these baselines to:\n1. Prioritize platforms â€” schedule to higher-performing platforms first.\n2. Select caption styles â€” track which opening patterns (questions, statistics, hooks, listicles) correlate with higher CTR per platform.\n3. Detect trends â€” if a category's engagement drops below 50% of its 30-day average for 3 consecutive posts, flag it as declining and suggest pivoting.\n4. Timing optimization â€” track post-to-click delay curves to identify peak engagement windows per platform."
        },
        {
          "key": "state_management",
          "label": "State File Schema",
          "content": "All state files are stored in the `state/` directory as JSON:\n- `last_check.json`: `{ \"last_checked_at\": \"ISO8601\", \"last_post_id\": 123 }`\n- `scheduled_posts.json`: Array of `{ \"wp_post_id\": 123, \"buffer_update_id\": \"abc\", \"platform\": \"twitter\", \"caption\": \"...\", \"scheduled_at\": \"ISO8601\", \"analyzed\": false }`\n- `performance_log.json`: Array of `{ \"wp_post_id\": 123, \"title\": \"...\", \"analyzed_at\": \"ISO8601\", \"ga\": { \"pageviews\": 0, \"avg_duration\": 0, \"bounce_rate\": 0 }, \"buffer\": { \"twitter\": { \"clicks\": 0, \"impressions\": 0 }, ... } }`\n- `strategy.json`: `{ \"platform_weights\": {}, \"category_baselines\": {}, \"caption_style_scores\": {}, \"updated_at\": \"ISO8601\" }`"
        },
        {
          "key": "communication_protocols",
          "label": "Communication Protocols",
          "content": "Use `agent_memory` to persist engagement patterns and strategy learnings between executions. This includes platform performance baselines, caption style effectiveness scores, and content category trends.\n\nUse `user_message` for:\n- Viral content alerts (engagement > 3x average)\n- Underperformance warnings (zero engagement after 48h)\n- Connector authentication failures requiring user action\n- Weekly strategy summaries (Mondays at 10:00 UTC) with top-performing content and recommended adjustments."
        }
      ]
    },
    "suggested_tools": [
      "http_request",
      "file_read",
      "file_write"
    ],
    "suggested_triggers": [
      {
        "trigger_type": "polling",
        "config": {
          "interval_seconds": 300
        },
        "description": "Poll WordPress REST API every 5 minutes for newly published posts"
      },
      {
        "trigger_type": "schedule",
        "config": {
          "cron": "0 9 * * *"
        },
        "description": "Daily at 09:00 UTC â€” review Google Analytics performance for posts published 48+ hours ago and update engagement strategy"
      },
      {
        "trigger_type": "schedule",
        "config": {
          "cron": "0 10 * * 1"
        },
        "description": "Weekly on Mondays at 10:00 UTC â€” generate and send a content performance summary with strategy recommendations"
      }
    ],
    "full_prompt_markdown": "# Content Distribution Strategist\n\nYou are an intelligent Content Distribution Strategist agent. You monitor a WordPress site for new blog posts, automatically schedule optimized social media promotions through Buffer across multiple platforms, track each post's performance via Google Analytics after 48 hours, and continuously refine your distribution strategy based on real engagement data.\n\n## Identity & Purpose\n\nYou replace four separate automation workflows:\n1. WordPress â†’ Buffer post scheduling\n2. WordPress â†’ social media caption generation\n3. Google Analytics â†’ performance reporting\n4. Content â†’ A/B caption testing and strategy optimization\n\nUnlike static automations, you reason about content context, adapt captions to each platform's culture, learn from engagement patterns, and proactively alert on viral content or underperformance.\n\n## Instructions\n\n### Step 1: Detect New WordPress Posts\n- Poll `GET /wp-json/wp/v2/posts?after={last_check_timestamp}&status=publish&per_page=20&orderby=date&order=asc` using the `wordpress` connector.\n- Track the last-checked timestamp in `state/last_check.json` to avoid reprocessing.\n- For each new post, extract: title, excerpt, permalink, slug, featured image (via `/wp-json/wp/v2/media/{id}`), categories (via `/wp-json/wp/v2/categories?post={id}`), tags (via `/wp-json/wp/v2/tags?post={id}`), and author.\n- Skip any posts not in `publish` status.\n\n### Step 2: Generate Platform-Optimized Captions\nFor each new post, craft captions tailored to each platform:\n- **Twitter/X**: Under 280 characters. Lead with a hook, question, or surprising stat from the post. Include 1-2 hashtags derived from post tags. End with a shortened link.\n- **LinkedIn**: Professional tone, 2-3 sentences. Frame the content's business value. Place the link on its own line for better click-through.\n- **Facebook**: Conversational and engaging. Use an emoji. Ask a question to drive comments. Include the link naturally.\n\nConsult `state/strategy.json` to check if the post's category has historical data. If so, favor the caption style (question, hook, stat-led) that has performed best for that category.\n\n### Step 3: Schedule via Buffer\n- Retrieve Buffer profile IDs: `GET https://api.bufferapp.com/1/profiles.json`.\n- For each platform caption, schedule: `POST https://api.bufferapp.com/1/updates/create.json` with `profile_ids`, `text`, `media` (link + featured image), `shorten: true`, `now: false`.\n- Log each scheduled update to `state/scheduled_posts.json` with the WordPress post ID, Buffer update ID, platform, caption text, and scheduled time.\n\n### Step 4: Performance Review (Daily 09:00 UTC)\n- Read `state/scheduled_posts.json` and filter for posts published 48+ hours ago with `analyzed: false`.\n- For each post, query Google Analytics: `POST https://analyticsdata.googleapis.com/v1beta/properties/{property_id}:runReport` with dimensions `pagePath` matching the post slug, and metrics: `screenPageViews`, `averageSessionDuration`, `bounceRate`, `sessions`.\n- Query Buffer engagement: `GET https://api.bufferapp.com/1/updates/{update_id}/interactions.json` for clicks, impressions, reshares.\n- Write results to `state/performance_log.json` and mark posts as `analyzed: true`.\n\n### Step 5: Update Distribution Strategy\n- After performance review, update `state/strategy.json`:\n  - Recalculate 30-day rolling engagement baselines per category and platform.\n  - Score caption styles by CTR correlation.\n  - Adjust platform priority weights based on traffic driven.\n  - Flag declining categories (3 consecutive posts below 50% of baseline).\n\n### Step 6: Alerts & Notifications\n- **Viral alert**: If a post exceeds 3x the category's average engagement within 48h, send a `user_message` with the title, metrics, top-performing platform, and follow-up content suggestions.\n- **Underperformance alert**: If a post has near-zero engagement after 48h, notify with the title and suggest caption revisions or resharing at a different time.\n- **Weekly summary** (Monday 10:00 UTC): Compile top 3 posts by engagement, worst performer, platform rankings, and strategy adjustment recommendations.\n\n## Tool Usage\n\n### WordPress (via `wordpress` connector + `http_request`)\n- `GET /wp-json/wp/v2/posts` â€” list/filter posts\n- `GET /wp-json/wp/v2/categories` â€” resolve category names\n- `GET /wp-json/wp/v2/tags` â€” resolve tags for hashtags\n- `GET /wp-json/wp/v2/media/{id}` â€” get featured image URL\n\n### Buffer (via `buffer` connector + `http_request`)\n- `GET /1/profiles.json` â€” list connected social profiles\n- `POST /1/updates/create.json` â€” schedule a social post\n- `GET /1/updates/{id}/interactions.json` â€” get engagement metrics\n- `GET /1/profiles/{id}/updates/pending.json` â€” check queue status\n\n### Google Analytics (via `google_analytics` connector + `http_request`)\n- `POST /v1beta/properties/{id}:runReport` â€” run analytics report\n- `POST /v1beta/properties/{id}:runRealtimeReport` â€” check real-time traffic\n\n### Local State Files (`file_read` / `file_write`)\n- `state/last_check.json` â€” polling checkpoint\n- `state/scheduled_posts.json` â€” scheduled post tracking\n- `state/performance_log.json` â€” historical engagement data\n- `state/strategy.json` â€” learned distribution strategy\n\n## Error Handling\n\n- **Authentication failures** (401/403): Notify user to refresh credentials. Do not retry with bad tokens.\n- **Rate limits** (429): Exponential backoff starting at 30s, max 3 retries.\n- **Empty results**: Normal for polling â€” update checkpoint and exit.\n- **Corrupted state files**: Reinitialize with defaults, log recovery.\n- **Buffer queue full**: Log post for retry, alert user about plan limits.\n- **GA property not found**: Log property ID, notify user to verify configuration.\n\n## Communication Protocols\n\n- **agent_memory**: Persist engagement patterns, platform weights, caption style scores, and category baselines between runs.\n- **user_message**: Viral alerts, underperformance warnings, authentication failures, weekly performance summaries.",
    "summary": "This Content Distribution Strategist agent automates the full lifecycle of blog content promotion â€” from detecting new WordPress posts, through generating platform-specific social media captions and scheduling them via Buffer, to analyzing Google Analytics performance data after 48 hours and iteratively refining its distribution strategy based on what actually drives engagement. It replaces four separate rigid workflows with a single reasoning agent that learns which platforms, caption styles, and timing work best for each content category.",
    "design_highlights": [
      {
        "category": "Content Detection",
        "icon": "ðŸ“¡",
        "color": "blue",
        "items": [
          "Polls WordPress REST API every 5 minutes for new posts",
          "Extracts title, excerpt, categories, tags, and featured images",
          "Maintains polling checkpoint to avoid duplicate processing",
          "Filters by publish status to skip drafts and private posts"
        ]
      },
      {
        "category": "Smart Distribution",
        "icon": "ðŸŽ¯",
        "color": "green",
        "items": [
          "Generates platform-optimized captions for Twitter, LinkedIn, and Facebook",
          "Adapts caption style based on historical engagement data",
          "Schedules via Buffer queue for optimal timing",
          "Includes featured images and shortened links automatically"
        ]
      },
      {
        "category": "Performance Intelligence",
        "icon": "ðŸ“Š",
        "color": "purple",
        "items": [
          "Reviews Google Analytics data 48 hours after publication",
          "Tracks pageviews, session duration, bounce rate, and traffic sources",
          "Cross-references with Buffer click and impression metrics",
          "Maintains 30-day rolling engagement baselines per category"
        ]
      },
      {
        "category": "Adaptive Strategy",
        "icon": "ðŸ§ ",
        "color": "orange",
        "items": [
          "Learns which platforms drive the most traffic per content category",
          "Scores caption styles by click-through rate correlation",
          "Detects declining content categories and flags for pivot",
          "Sends viral alerts and underperformance warnings proactively"
        ]
      }
    ],
    "suggested_connectors": [
      {
        "name": "wordpress",
        "label": "WordPress",
        "auth_type": "api_key",
        "credential_fields": [
          {
            "key": "site_url",
            "label": "WordPress Site URL",
            "type": "text",
            "placeholder": "https://yourblog.com",
            "helpText": "Your WordPress site's base URL (without /wp-json)",
            "required": true
          },
          {
            "key": "username",
            "label": "WordPress Username",
            "type": "text",
            "placeholder": "admin",
            "helpText": "The WordPress user account with REST API access",
            "required": true
          },
          {
            "key": "application_password",
            "label": "Application Password",
            "type": "password",
            "placeholder": "xxxx xxxx xxxx xxxx xxxx xxxx",
            "helpText": "Generate in WP Admin â†’ Users â†’ Your Profile â†’ Application Passwords. Click 'Add New Application Password', name it 'Personas Agent', and copy the generated password.",
            "required": true
          }
        ],
        "setup_instructions": "1. Log in to your WordPress admin dashboard.\n2. Go to Users â†’ Your Profile.\n3. Scroll down to the 'Application Passwords' section.\n4. Enter 'Personas Agent' as the application name and click 'Add New Application Password'.\n5. Copy the generated password immediately (it won't be shown again).\n6. Ensure the WordPress REST API is accessible at https://yoursite.com/wp-json/wp/v2/posts.\n7. If using a security plugin, ensure it does not block REST API requests with Application Password authentication.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [
          0
        ],
        "api_base_url": "https://{site}/wp-json/wp/v2"
      },
      {
        "name": "buffer",
        "label": "Buffer",
        "auth_type": "api_key",
        "credential_fields": [
          {
            "key": "access_token",
            "label": "Buffer Access Token",
            "type": "password",
            "placeholder": "1/abcdef1234567890",
            "helpText": "Get your access token from the Buffer Developer Portal at https://buffer.com/developers/apps. Create an app, then use the generated access token.",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to https://buffer.com/developers/apps and log in with your Buffer account.\n2. Click 'Create an App' and fill in the required details (name: 'Personas Agent', redirect URI can be http://localhost).\n3. After creating the app, navigate to the app details to find your Access Token.\n4. Alternatively, use the Buffer API console at https://buffer.com/developers/api/oauth to generate a token.\n5. Ensure your Buffer account has at least one social media profile connected (Twitter, LinkedIn, or Facebook).\n6. Verify the token works by visiting https://api.bufferapp.com/1/profiles.json?access_token=YOUR_TOKEN in your browser.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [
          0
        ],
        "api_base_url": "https://api.bufferapp.com/1"
      },
      {
        "name": "google_analytics",
        "label": "Google Analytics (GA4)",
        "auth_type": "oauth2",
        "credential_fields": [
          {
            "key": "property_id",
            "label": "GA4 Property ID",
            "type": "text",
            "placeholder": "123456789",
            "helpText": "Find in Google Analytics â†’ Admin â†’ Property Settings. It's the numeric ID (not the measurement ID starting with G-).",
            "required": true
          },
          {
            "key": "client_id",
            "label": "OAuth2 Client ID",
            "type": "text",
            "placeholder": "xxxx.apps.googleusercontent.com",
            "helpText": "From Google Cloud Console â†’ APIs & Services â†’ Credentials â†’ OAuth 2.0 Client IDs",
            "required": true
          },
          {
            "key": "client_secret",
            "label": "OAuth2 Client Secret",
            "type": "password",
            "placeholder": "GOCSPX-xxxxxxxx",
            "helpText": "From the same OAuth 2.0 Client ID page in Google Cloud Console",
            "required": true
          },
          {
            "key": "refresh_token",
            "label": "OAuth2 Refresh Token",
            "type": "password",
            "placeholder": "1//0xxxxxxxx",
            "helpText": "Generated during the OAuth2 consent flow. Use the Google OAuth Playground (https://developers.google.com/oauthplayground/) with scope 'https://www.googleapis.com/auth/analytics.readonly' to generate one.",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to Google Cloud Console (https://console.cloud.google.com).\n2. Create or select a project, then enable the 'Google Analytics Data API' under APIs & Services â†’ Library.\n3. Go to APIs & Services â†’ Credentials â†’ Create Credentials â†’ OAuth 2.0 Client ID.\n4. Set the application type to 'Web application' and add https://developers.google.com/oauthplayground as an authorized redirect URI.\n5. Copy the Client ID and Client Secret.\n6. Go to https://developers.google.com/oauthplayground, click the gear icon, check 'Use your own OAuth credentials', and paste your Client ID and Client Secret.\n7. In Step 1, find 'Google Analytics Data API v1' and select the `analytics.readonly` scope.\n8. Click 'Authorize APIs', sign in, and grant consent.\n9. In Step 2, click 'Exchange authorization code for tokens' and copy the Refresh Token.\n10. Find your GA4 Property ID in Google Analytics â†’ Admin â†’ Property Settings (the numeric ID, not the G- measurement ID).",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [
          1,
          2
        ],
        "api_base_url": "https://analyticsdata.googleapis.com"
      }
    ],
    "suggested_notification_channels": [
      {
        "type": "email",
        "description": "Receive viral content alerts, underperformance warnings, and weekly content performance summaries via email",
        "required_connector": "gmail",
        "config_hints": {
          "to": "content-team@yourcompany.com",
          "subject_prefix": "[Content Agent]"
        }
      }
    ],
    "suggested_event_subscriptions": [
      {
        "event_type": "post_published",
        "description": "Triggered when a new WordPress post is detected during polling. Initiates the caption generation and Buffer scheduling workflow."
      },
      {
        "event_type": "performance_review_due",
        "description": "Triggered by the daily schedule when posts are 48+ hours old and haven't been analyzed yet. Initiates Google Analytics data collection and strategy update."
      },
      {
        "event_type": "viral_content_detected",
        "description": "Emitted when a post's engagement exceeds 3x the category baseline within 48 hours. Triggers user notification with follow-up content recommendations."
      },
      {
        "event_type": "connector_auth_failure",
        "description": "Emitted when any connector returns a 401/403 authentication error. Triggers user notification to refresh credentials."
      }
    ],
    "use_case_flows": [
      {
        "id": "flow_1",
        "name": "New Post Detection & Distribution",
        "description": "Detects newly published WordPress posts, generates platform-optimized social media captions, and schedules them via Buffer",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Polling trigger fires",
            "detail": "Every 5 minutes, the polling trigger activates the agent"
          },
          {
            "id": "n2",
            "type": "action",
            "label": "Read last checkpoint",
            "detail": "Read state/last_check.json to get the timestamp of the last processed post"
          },
          {
            "id": "n3",
            "type": "connector",
            "label": "Fetch new WordPress posts",
            "detail": "GET /wp-json/wp/v2/posts?after={timestamp}&status=publish&per_page=20",
            "connector": "wordpress"
          },
          {
            "id": "n4",
            "type": "decision",
            "label": "New posts found?",
            "detail": "Check if the API returned any posts published since last check"
          },
          {
            "id": "n5",
            "type": "connector",
            "label": "Fetch post metadata",
            "detail": "GET categories, tags, and featured image for each new post via WordPress REST API",
            "connector": "wordpress"
          },
          {
            "id": "n6",
            "type": "action",
            "label": "Load engagement strategy",
            "detail": "Read state/strategy.json to check historical performance for the post's content category"
          },
          {
            "id": "n7",
            "type": "action",
            "label": "Generate platform captions",
            "detail": "Craft optimized captions for Twitter (280 char hook), LinkedIn (professional framing), and Facebook (conversational with emoji)"
          },
          {
            "id": "n8",
            "type": "connector",
            "label": "Get Buffer profiles",
            "detail": "GET /1/profiles.json to retrieve connected social media profile IDs",
            "connector": "buffer"
          },
          {
            "id": "n9",
            "type": "connector",
            "label": "Schedule Buffer updates",
            "detail": "POST /1/updates/create.json for each platform with caption, link, and featured image",
            "connector": "buffer"
          },
          {
            "id": "n10",
            "type": "decision",
            "label": "Scheduling successful?",
            "detail": "Check if Buffer API returned success for all platform updates"
          },
          {
            "id": "n11",
            "type": "action",
            "label": "Log scheduled posts",
            "detail": "Write post ID, Buffer update IDs, platforms, captions, and timestamps to state/scheduled_posts.json"
          },
          {
            "id": "n12",
            "type": "action",
            "label": "Update checkpoint",
            "detail": "Write current timestamp to state/last_check.json"
          },
          {
            "id": "n13",
            "type": "error",
            "label": "Handle scheduling failure",
            "detail": "Log failed platform, check for queue-full or rate-limit errors, mark for retry"
          },
          {
            "id": "n14",
            "type": "event",
            "label": "Emit post_published event",
            "detail": "Record the distribution event for performance tracking"
          },
          {
            "id": "n15",
            "type": "end",
            "label": "Distribution complete"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4"
          },
          {
            "id": "e4",
            "source": "n4",
            "target": "n5",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n12",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7"
          },
          {
            "id": "e8",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e9",
            "source": "n8",
            "target": "n9"
          },
          {
            "id": "e10",
            "source": "n9",
            "target": "n10"
          },
          {
            "id": "e11",
            "source": "n10",
            "target": "n11",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e12",
            "source": "n10",
            "target": "n13",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e13",
            "source": "n11",
            "target": "n14"
          },
          {
            "id": "e14",
            "source": "n14",
            "target": "n15"
          },
          {
            "id": "e15",
            "source": "n13",
            "target": "n12",
            "variant": "error"
          },
          {
            "id": "e16",
            "source": "n12",
            "target": "n15"
          }
        ]
      },
      {
        "id": "flow_2",
        "name": "48-Hour Performance Review & Strategy Update",
        "description": "Analyzes Google Analytics and Buffer engagement data for posts published 48+ hours ago, updates the distribution strategy based on findings",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Daily schedule trigger",
            "detail": "Fires at 09:00 UTC every day"
          },
          {
            "id": "n2",
            "type": "action",
            "label": "Load scheduled posts",
            "detail": "Read state/scheduled_posts.json and filter for posts 48+ hours old with analyzed=false"
          },
          {
            "id": "n3",
            "type": "decision",
            "label": "Unanalyzed posts exist?",
            "detail": "Check if any posts need performance review"
          },
          {
            "id": "n4",
            "type": "connector",
            "label": "Query Google Analytics",
            "detail": "POST /v1beta/properties/{id}:runReport with pagePath dimension matching post slugs, metrics: pageviews, session duration, bounce rate",
            "connector": "google_analytics"
          },
          {
            "id": "n5",
            "type": "connector",
            "label": "Query Buffer interactions",
            "detail": "GET /1/updates/{update_id}/interactions.json for clicks, impressions, reshares per platform",
            "connector": "buffer"
          },
          {
            "id": "n6",
            "type": "action",
            "label": "Calculate engagement scores",
            "detail": "Compute CTR, engagement rate, and platform-relative performance for each post"
          },
          {
            "id": "n7",
            "type": "decision",
            "label": "Viral threshold exceeded?",
            "detail": "Check if any post's engagement exceeds 3x the category baseline"
          },
          {
            "id": "n8",
            "type": "event",
            "label": "Send viral alert",
            "detail": "Emit user_message with post title, metrics, top platform, and follow-up content suggestions"
          },
          {
            "id": "n9",
            "type": "decision",
            "label": "Zero engagement detected?",
            "detail": "Check if any post has near-zero clicks and pageviews after 48h"
          },
          {
            "id": "n10",
            "type": "event",
            "label": "Send underperformance warning",
            "detail": "Emit user_message suggesting caption revision or resharing at different time"
          },
          {
            "id": "n11",
            "type": "action",
            "label": "Update strategy file",
            "detail": "Recalculate 30-day baselines, platform weights, caption style scores in state/strategy.json"
          },
          {
            "id": "n12",
            "type": "action",
            "label": "Mark posts as analyzed",
            "detail": "Set analyzed=true in state/scheduled_posts.json and write performance data to state/performance_log.json"
          },
          {
            "id": "n13",
            "type": "error",
            "label": "Handle analytics failure",
            "detail": "Log GA/Buffer API errors, skip affected posts, notify user if auth expired"
          },
          {
            "id": "n14",
            "type": "end",
            "label": "Review complete"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e4",
            "source": "n3",
            "target": "n14",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7"
          },
          {
            "id": "e8",
            "source": "n7",
            "target": "n8",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e9",
            "source": "n7",
            "target": "n9",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e10",
            "source": "n8",
            "target": "n9"
          },
          {
            "id": "e11",
            "source": "n9",
            "target": "n10",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e12",
            "source": "n9",
            "target": "n11",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e13",
            "source": "n10",
            "target": "n11"
          },
          {
            "id": "e14",
            "source": "n11",
            "target": "n12"
          },
          {
            "id": "e15",
            "source": "n12",
            "target": "n14"
          },
          {
            "id": "e16",
            "source": "n4",
            "target": "n13",
            "variant": "error"
          },
          {
            "id": "e17",
            "source": "n13",
            "target": "n14",
            "variant": "error"
          }
        ]
      },
      {
        "id": "flow_3",
        "name": "Weekly Performance Summary",
        "description": "Compiles a weekly content performance report with top posts, platform rankings, and strategic recommendations",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Weekly schedule trigger",
            "detail": "Fires Monday at 10:00 UTC"
          },
          {
            "id": "n2",
            "type": "action",
            "label": "Load performance log",
            "detail": "Read state/performance_log.json and filter for posts analyzed in the last 7 days"
          },
          {
            "id": "n3",
            "type": "decision",
            "label": "Sufficient data?",
            "detail": "Check if at least 2 posts were analyzed this week to generate meaningful insights"
          },
          {
            "id": "n4",
            "type": "action",
            "label": "Rank posts by engagement",
            "detail": "Sort posts by total engagement (pageviews + clicks + reshares) to identify top 3 and worst performer"
          },
          {
            "id": "n5",
            "type": "action",
            "label": "Calculate platform rankings",
            "detail": "Aggregate clicks and impressions by platform to rank Twitter vs LinkedIn vs Facebook effectiveness"
          },
          {
            "id": "n6",
            "type": "action",
            "label": "Load strategy trends",
            "detail": "Read state/strategy.json to identify week-over-week changes in platform weights and category baselines"
          },
          {
            "id": "n7",
            "type": "action",
            "label": "Generate recommendations",
            "detail": "Compile strategic advice: best-performing categories, recommended caption styles, optimal platforms, and declining topics to reconsider"
          },
          {
            "id": "n8",
            "type": "event",
            "label": "Send weekly summary",
            "detail": "Emit user_message with formatted report: top 3 posts, worst performer, platform rankings, and action items"
          },
          {
            "id": "n9",
            "type": "end",
            "label": "Summary delivered"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e4",
            "source": "n3",
            "target": "n9",
            "label": "No",
            "variant": "no"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7"
          },
          {
            "id": "e8",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e9",
            "source": "n8",
            "target": "n9"
          }
        ]
      }
    ]
  }
}
