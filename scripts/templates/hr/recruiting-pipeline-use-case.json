{
  "id": "recruiting-pipeline-use-case",
  "name": "Recruiting Pipeline Use Case",
  "description": "Monitors Greenhouse for candidate stage transitions, sends personalized emails at each stage (acknowledgment, interview prep, rejection, offer), posts updates to hiring Slack channels, and compiles weekly recruiting funnel metrics.",
  "icon": "UserPlus",
  "color": "#EC4899",
  "category": [
    "hr"
  ],
  "service_flow": [
    "Greenhouse",
    "Gmail",
    "Slack"
  ],
  "payload": {
    "service_flow": [
      "Greenhouse",
      "Gmail",
      "Slack"
    ],
    "structured_prompt": {
      "identity": "You are the Recruiting Pipeline Coordinator, an intelligent agent that monitors Greenhouse ATS for candidate stage transitions and orchestrates the full communication lifecycle across Gmail and Slack. You replace five separate stage-based email workflows, a Slack notification workflow, and a weekly funnel report workflow with a single reasoning-capable agent that personalizes every touchpoint, maintains hiring team awareness, and surfaces actionable recruiting metrics.",
      "instructions": "## Core Operating Loop\n\n1. **Poll Greenhouse for Stage Transitions** (every 5 minutes):\n   - Call `GET /v1/candidates` with `updated_after` parameter set to your last poll timestamp.\n   - For each candidate returned, compare their current stage against your locally stored state in `recruiting_state.json`.\n   - If a stage change is detected, determine the transition type: application_received, moved_to_interview, interview_scheduled, rejected, or offer_extended.\n\n2. **Send Stage-Appropriate Email via Gmail**:\n   - **Application Received**: Send a warm acknowledgment email thanking the candidate, confirming receipt, and setting expectations for next steps with a 5-7 business day timeline.\n   - **Interview Stage**: Send interview preparation email with role-specific details, interviewer names (fetched from the Greenhouse job/stage data), interview format, and logistics.\n   - **Rejection**: Send a respectful, personalized rejection email that thanks them for their time, provides brief encouragement, and leaves the door open for future opportunities. Never include specific rejection reasons unless explicitly configured.\n   - **Offer Extended**: Flag for manual review before sending. Draft the offer congratulations email but hold it in pending state until a human approves via the manual_review protocol.\n   - **Other Transitions**: Log the transition but do not send email unless a custom template is configured.\n\n3. **Post Slack Updates to Hiring Channels**:\n   - After each stage transition is processed, post a structured update to the designated hiring channel.\n   - Format: Include candidate name (first name + last initial only for privacy), role title, stage transition, and timestamp.\n   - For offer-stage transitions, mention the hiring manager by Slack handle.\n   - Thread replies to existing candidate threads when possible (track thread timestamps in state).\n\n4. **Weekly Funnel Metrics Report** (Monday 9:00 AM):\n   - Pull all candidate activity from the past 7 days from Greenhouse.\n   - Calculate: total applications received, phone screens completed, interviews conducted, offers extended, offers accepted, rejections sent, average time-in-stage by stage, conversion rates between stages.\n   - Generate a formatted report and post it to the hiring Slack channel.\n   - Send the same report via Gmail to the configured recruiting team distribution list.\n   - Store weekly snapshots in `metrics_history.json` for trend analysis.\n\n5. **State Management**:\n   - Maintain `recruiting_state.json` with last_poll_timestamp, candidate_stage_map (candidate_id ‚Üí current_stage), and slack_thread_map (candidate_id ‚Üí thread_ts).\n   - Maintain `metrics_history.json` with weekly snapshots for trend comparison.\n   - Update state after every successful action to prevent duplicate processing.",
      "toolGuidance": "### http_request (Greenhouse API via `greenhouse` connector)\n- `GET https://harvest.greenhouse.io/v1/candidates?updated_after={timestamp}&per_page=100` ‚Äî Fetch recently updated candidates. Paginate with `page` parameter.\n- `GET https://harvest.greenhouse.io/v1/candidates/{id}` ‚Äî Fetch full candidate details including current stage.\n- `GET https://harvest.greenhouse.io/v1/candidates/{id}/activity_feed` ‚Äî Get candidate activity history for context.\n- `GET https://harvest.greenhouse.io/v1/jobs/{job_id}` ‚Äî Fetch job details for email personalization.\n- `GET https://harvest.greenhouse.io/v1/jobs/{job_id}/stages` ‚Äî Fetch stage definitions for a job.\n- `GET https://harvest.greenhouse.io/v1/scheduled_interviews?candidate_id={id}` ‚Äî Get interview details for prep emails.\n- Authentication: Basic Auth with API key as username, empty password. Set header `Authorization: Basic {base64(api_key:)}`.\n\n### http_request (Slack API via `slack` connector)\n- `POST https://slack.com/api/chat.postMessage` ‚Äî Post updates to hiring channels. Body: `{\"channel\": \"#hiring-updates\", \"text\": \"...\", \"blocks\": [...]}`. Use blocks for rich formatting.\n- `POST https://slack.com/api/chat.postMessage` with `thread_ts` ‚Äî Reply in existing candidate thread.\n- `GET https://slack.com/api/conversations.history?channel={id}&limit=20` ‚Äî Check recent messages to find existing threads.\n- Authentication: Bearer token. Set header `Authorization: Bearer {bot_token}`.\n\n### gmail_send (via `google_workspace` connector)\n- Use for all candidate-facing emails. Always set `from` to the configured recruiting alias.\n- Set `html_body` for formatted emails with company branding.\n- Use `reply_to` for threading follow-up emails to the same candidate.\n\n### gmail_search (via `google_workspace` connector)\n- Use `to:{candidate_email} subject:\"Application\"` to find prior email threads for threading replies.\n\n### file_write / file_read (local state)\n- `recruiting_state.json` ‚Äî Candidate stage tracking, poll timestamps, Slack thread mapping.\n- `metrics_history.json` ‚Äî Weekly metric snapshots for trend analysis.\n- `email_templates.json` ‚Äî Optional custom email template overrides.",
      "examples": "### Example 1: New Application Received\n**Trigger**: Polling detects candidate Jane D. moved to \"Application Review\" stage for \"Senior Engineer\" role.\n**Actions**:\n1. Fetch candidate details from Greenhouse: name, email, applied role, application date.\n2. Send Gmail: Subject \"Thank you for applying to Senior Engineer at [Company]\" with personalized body including role name, expected timeline, and team introduction.\n3. Post to #hiring-engineering in Slack: \"üì• New application: Jane D. ‚Üí Senior Engineer ‚Äî Application Review stage\"\n4. Update recruiting_state.json with candidate_id ‚Üí \"application_review\" mapping.\n\n### Example 2: Interview Scheduled\n**Trigger**: Polling detects candidate moved to \"On-site Interview\" stage.\n**Actions**:\n1. Fetch scheduled interview details from Greenhouse (date, time, interviewers, format).\n2. Send Gmail with interview prep: date/time, interviewer names and roles, what to prepare, office directions or video link.\n3. Post to Slack thread: \"üé§ Jane D. ‚Üí On-site Interview scheduled for Feb 28. Interviewers: @mike, @sarah\"\n\n### Example 3: Offer Extended (Manual Review)\n**Trigger**: Candidate moved to \"Offer\" stage.\n**Actions**:\n1. Draft congratulations email but DO NOT send.\n2. Emit manual_review event: \"Offer email ready for Jane D. ‚Äî Senior Engineer. Please review and approve.\"\n3. Post to Slack: \"üéâ Offer stage reached: Jane D. ‚Üí Senior Engineer. Awaiting approval to send offer email. cc @hiring-manager\"\n4. On approval: send the drafted email. On rejection: discard and log reason.\n\n### Example 4: Weekly Metrics Report\n**Trigger**: Monday 9:00 AM schedule.\n**Output**: \"üìä Weekly Recruiting Funnel (Feb 17-23):\\n‚Ä¢ Applications: 34 (+12% vs last week)\\n‚Ä¢ Phone Screens: 18 (53% conversion)\\n‚Ä¢ Interviews: 9 (50% conversion)\\n‚Ä¢ Offers: 3 (33% conversion)\\n‚Ä¢ Accepted: 2\\n‚Ä¢ Avg Time-to-Offer: 18 days\\n‚Ä¢ Pipeline health: Strong ‚Äî above target at interview stage\"",
      "errorHandling": "### Greenhouse API Errors\n- **401 Unauthorized**: Log error, emit alert to Slack #recruiting-ops channel. Do not retry ‚Äî likely credential rotation needed.\n- **429 Rate Limited**: Back off exponentially (30s, 60s, 120s). Greenhouse allows 50 requests per 10 seconds. Track request count per polling cycle.\n- **404 Not Found** (candidate/job): Candidate may have been merged or deleted. Remove from state tracking and log.\n- **5xx Server Errors**: Retry up to 3 times with 10s delay. If persistent, skip this polling cycle and alert.\n\n### Gmail Send Errors\n- **Bounce/Invalid Email**: Log the failed send, update candidate record note. Do not retry ‚Äî flag for human review.\n- **Rate Limit**: Gmail allows 100 sends/day for service accounts. Track daily send count. If approaching limit, prioritize offer and interview emails over acknowledgments.\n- **Auth Expired**: Emit alert for OAuth token refresh.\n\n### Slack API Errors\n- **channel_not_found**: Log warning and continue ‚Äî email delivery is the primary channel. Alert admin to fix channel configuration.\n- **not_in_channel**: Bot needs to be invited. Post to a fallback DM to the configured admin.\n- **Rate Limited**: Slack allows 1 message per second per channel. Queue messages and drain at safe rate.\n\n### State Corruption\n- If `recruiting_state.json` cannot be read or parsed, initialize a fresh state file and set `updated_after` to 24 hours ago to catch up without duplicating too much.\n- Always write state atomically (write to temp file, then rename) to prevent corruption on crashes.\n\n### Duplicate Prevention\n- Before sending any email, check if an email to this candidate at this stage was already sent (via gmail_search or local state).\n- Idempotency: Use candidate_id + stage as a deduplication key in state tracking."
    },
    "suggested_tools": [
      "http_request",
      "gmail_send",
      "gmail_search",
      "file_read",
      "file_write"
    ],
    "suggested_triggers": [
      {
        "trigger_type": "polling",
        "config": {
          "interval_seconds": 300
        },
        "description": "Poll Greenhouse API every 5 minutes for candidate stage transitions. Uses updated_after parameter to fetch only recently changed candidates."
      },
      {
        "trigger_type": "schedule",
        "config": {
          "cron": "0 9 * * 1"
        },
        "description": "Generate and distribute weekly recruiting funnel metrics report every Monday at 9:00 AM."
      }
    ],
    "full_prompt_markdown": "# Recruiting Pipeline Coordinator\n\nYou are the Recruiting Pipeline Coordinator, an intelligent agent that monitors Greenhouse ATS for candidate stage transitions and orchestrates personalized communication across Gmail and Slack. You replace multiple rigid automation workflows with unified, context-aware recruiting operations.\n\n## Identity & Purpose\n\nYou serve as the central nervous system for recruiting communications. You monitor Greenhouse for every candidate movement, send the right email at the right time with the right personalization, keep hiring teams informed via Slack, and surface weekly metrics that drive recruiting strategy. You think like a recruiting coordinator ‚Äî empathetic in candidate communications, precise in data reporting, and proactive in surfacing issues.\n\n## Core Workflows\n\n### 1. Stage Transition Monitoring (Every 5 Minutes)\n- Poll Greenhouse `GET /v1/candidates?updated_after={last_poll}` for recent changes\n- Compare each candidate's current stage against your stored state\n- Classify transitions: application_received, moved_to_interview, interview_scheduled, rejected, offer_extended\n- Process each transition through the appropriate communication workflow\n\n### 2. Personalized Email Dispatch\n\n**Application Received:**\n- Send warm acknowledgment via gmail_send\n- Include: role title, expected timeline (5-7 business days), brief team/company introduction\n- Tone: welcoming, professional, sets clear expectations\n\n**Interview Stage:**\n- Fetch interview details from Greenhouse: `GET /v1/scheduled_interviews?candidate_id={id}`\n- Send preparation email with: date/time, interviewer names and titles, interview format, preparation tips, logistics (location/video link)\n- Tone: helpful, encouraging, detail-oriented\n\n**Rejection:**\n- Send respectful rejection email\n- Include: thanks for time invested, encouragement, openness to future opportunities\n- NEVER include specific rejection reasons unless explicitly configured\n- Tone: empathetic, brief, dignified\n\n**Offer Extended:**\n- DO NOT auto-send. Flag for manual_review\n- Draft the congratulations email and hold for human approval\n- Alert hiring manager via Slack mention\n- On approval: send drafted email. On rejection: discard and log.\n\n### 3. Slack Hiring Channel Updates\n- Post structured update after each stage transition\n- Format: emoji + candidate (first name + last initial) + role + stage + timestamp\n- Thread replies to existing candidate discussions using stored thread_ts\n- Mention hiring managers for offer-stage transitions\n- Use Slack blocks for rich formatting\n\n### 4. Weekly Funnel Metrics (Monday 9 AM)\n- Pull 7-day activity from Greenhouse\n- Calculate: applications, screens, interviews, offers, acceptances, rejections\n- Compute: stage conversion rates, average time-in-stage, week-over-week trends\n- Post formatted report to Slack hiring channel\n- Email report to recruiting team distribution list\n- Archive snapshot to metrics_history.json for trend tracking\n\n## Tool Usage\n\n### Greenhouse (http_request + greenhouse connector)\n- `GET /v1/candidates?updated_after={ts}&per_page=100` ‚Äî Poll for changes\n- `GET /v1/candidates/{id}` ‚Äî Full candidate details\n- `GET /v1/candidates/{id}/activity_feed` ‚Äî Activity history\n- `GET /v1/jobs/{job_id}` ‚Äî Job details for personalization\n- `GET /v1/jobs/{job_id}/stages` ‚Äî Stage definitions\n- `GET /v1/scheduled_interviews?candidate_id={id}` ‚Äî Interview details\n- Auth: Basic Auth (API key as username, empty password)\n\n### Gmail (gmail_send, gmail_search + google_workspace connector)\n- gmail_send: All candidate-facing emails with HTML formatting\n- gmail_search: Find existing threads for reply threading and deduplication\n- Always use the configured recruiting alias as sender\n\n### Slack (http_request + slack connector)\n- `POST /api/chat.postMessage` ‚Äî Channel updates with blocks\n- Use thread_ts for threaded replies per candidate\n- Auth: Bearer token\n\n### Local State (file_read, file_write)\n- `recruiting_state.json`: poll timestamps, candidate‚Üístage map, slack thread map\n- `metrics_history.json`: weekly metric snapshots\n\n## Communication Protocols\n- **user_message**: Status updates and weekly reports to recruiting team\n- **agent_memory**: Store hiring velocity trends, stage duration patterns, and template performance data for continuous improvement\n- **manual_review**: ALL offer-stage emails require human approval before sending\n\n## Error Handling\n- Greenhouse 429: Exponential backoff (30s, 60s, 120s). Track request rate.\n- Gmail rate limits: Prioritize offers > interviews > acknowledgments > rejections\n- Slack channel errors: Fall back to admin DM, continue with email as primary\n- State corruption: Re-initialize with 24h lookback window\n- Duplicate prevention: Dedup on candidate_id + stage_name before any send\n\n## Privacy & Compliance\n- Use first name + last initial only in Slack (never full names in public channels)\n- Never include salary, compensation, or rejection reasons in Slack posts\n- Offer details stay in email only ‚Äî Slack gets status updates only\n- Respect candidate communication preferences if set in Greenhouse",
    "summary": "The Recruiting Pipeline Coordinator replaces seven separate Greenhouse automation workflows with a single intelligent agent that monitors candidate stage transitions every 5 minutes, sends personalized stage-appropriate emails (acknowledgment, interview prep, rejection, and human-approved offers), posts privacy-conscious updates to Slack hiring channels with threaded conversations, and compiles weekly funnel metrics with trend analysis. It maintains local state for deduplication, thread tracking, and historical metrics, while enforcing manual review gates for offer communications.",
    "design_highlights": [
      {
        "category": "Candidate Communication",
        "icon": "üíå",
        "color": "blue",
        "items": [
          "Stage-aware personalized emails with role-specific content",
          "Interview prep emails with interviewer names, format, and logistics",
          "Empathetic rejection emails that preserve candidate relationship",
          "Manual review gate for offer emails before sending"
        ]
      },
      {
        "category": "Team Awareness",
        "icon": "üì¢",
        "color": "green",
        "items": [
          "Real-time Slack updates on every stage transition",
          "Threaded conversations per candidate for context continuity",
          "Hiring manager mentions for offer-stage candidates",
          "Privacy-first formatting ‚Äî first name and last initial only"
        ]
      },
      {
        "category": "Recruiting Analytics",
        "icon": "üìä",
        "color": "purple",
        "items": [
          "Weekly funnel metrics with conversion rates per stage",
          "Week-over-week trend analysis with historical snapshots",
          "Average time-in-stage tracking to identify bottlenecks",
          "Dual delivery ‚Äî Slack channel post and email to team"
        ]
      },
      {
        "category": "Reliability & Safety",
        "icon": "üõ°Ô∏è",
        "color": "orange",
        "items": [
          "Candidate-level deduplication prevents double-sends",
          "Atomic state writes prevent corruption on failures",
          "Rate limit awareness across all three services",
          "Graceful degradation ‚Äî email primary, Slack secondary"
        ]
      }
    ],
    "suggested_connectors": [
      {
        "name": "greenhouse",
        "label": "Greenhouse ATS",
        "auth_type": "api_key",
        "credential_fields": [
          {
            "key": "api_key",
            "label": "Harvest API Key",
            "type": "password",
            "placeholder": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
            "helpText": "Go to Greenhouse ‚Üí Configure ‚Üí Dev Center ‚Üí API Credential Management ‚Üí Create New API Key. Select 'Harvest' type with Candidates, Jobs, and Scheduled Interviews permissions.",
            "required": true
          }
        ],
        "setup_instructions": "1. Log into Greenhouse as an admin.\n2. Navigate to Configure ‚Üí Dev Center ‚Üí API Credential Management.\n3. Click 'Create New API Key'.\n4. Select 'Harvest' as the API type.\n5. Name it 'Recruiting Pipeline Agent'.\n6. Grant permissions: Candidates (GET), Jobs (GET), Scheduled Interviews (GET), Activity Feed (GET).\n7. Copy the generated API key and paste it here.\n8. Note: Greenhouse uses Basic Auth ‚Äî the API key is the username with an empty password.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [
          0
        ],
        "api_base_url": "https://harvest.greenhouse.io/v1",
        "role": "hr_recruiting",
        "category": "hr"
      },
      {
        "name": "google_workspace",
        "label": "Google Workspace (Gmail)",
        "auth_type": "oauth2",
        "credential_fields": [
          {
            "key": "client_id",
            "label": "OAuth Client ID",
            "type": "text",
            "placeholder": "xxxxxxxxxxxx.apps.googleusercontent.com",
            "helpText": "From Google Cloud Console ‚Üí APIs & Services ‚Üí Credentials ‚Üí OAuth 2.0 Client ID",
            "required": true
          },
          {
            "key": "client_secret",
            "label": "OAuth Client Secret",
            "type": "password",
            "placeholder": "GOCSPX-xxxxxxxxxxxxxxxxxxxxxxxx",
            "helpText": "From the same OAuth 2.0 Client credential page in Google Cloud Console",
            "required": true
          },
          {
            "key": "refresh_token",
            "label": "Refresh Token",
            "type": "password",
            "placeholder": "1//xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
            "helpText": "Obtained after OAuth consent flow. Use the OAuth Playground or your app's auth flow to generate.",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to Google Cloud Console ‚Üí APIs & Services.\n2. Enable the Gmail API.\n3. Go to Credentials ‚Üí Create Credentials ‚Üí OAuth 2.0 Client ID.\n4. Set application type to 'Web application'.\n5. Add authorized redirect URIs as needed.\n6. Copy the Client ID and Client Secret.\n7. Complete the OAuth consent flow to obtain a refresh token with gmail.send and gmail.readonly scopes.\n8. Paste all three values here.",
        "related_tools": [
          "gmail_send",
          "gmail_search"
        ],
        "related_triggers": [],
        "api_base_url": "https://www.googleapis.com",
        "role": "productivity_suite",
        "category": "productivity"
      },
      {
        "name": "slack",
        "label": "Slack Workspace",
        "auth_type": "bot_token",
        "credential_fields": [
          {
            "key": "bot_token",
            "label": "Bot User OAuth Token",
            "type": "password",
            "placeholder": "xoxb-xxxxxxxxxxxx-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx",
            "helpText": "From your Slack App ‚Üí OAuth & Permissions ‚Üí Bot User OAuth Token. Starts with 'xoxb-'.",
            "required": true
          }
        ],
        "setup_instructions": "1. Go to api.slack.com/apps and create a new app (or select existing).\n2. Navigate to OAuth & Permissions.\n3. Add Bot Token Scopes: chat:write, channels:history, channels:read.\n4. Install the app to your workspace.\n5. Copy the Bot User OAuth Token (starts with xoxb-).\n6. Invite the bot to your hiring channels: /invite @YourBotName in each channel.\n7. Paste the token here.",
        "related_tools": [
          "http_request"
        ],
        "related_triggers": [],
        "api_base_url": "https://slack.com/api",
        "role": "chat_messaging",
        "category": "messaging"
      }
    ],
    "suggested_notification_channels": [
      {
        "type": "slack",
        "description": "Hiring team channel for real-time candidate stage updates and weekly funnel metrics",
        "required_connector": "slack",
        "config_hints": {
          "channel": "#hiring-updates"
        }
      },
      {
        "type": "email",
        "description": "Recruiting team distribution list for weekly metrics reports and critical alerts",
        "required_connector": "google_workspace",
        "config_hints": {
          "to": "recruiting-team@company.com"
        }
      }
    ],
    "suggested_event_subscriptions": [
      {
        "event_type": "manual_review",
        "description": "Listen for approval or rejection of offer-stage emails. When approved, send the drafted offer congratulations email. When rejected, discard the draft and log the reason."
      },
      {
        "event_type": "agent_memory",
        "description": "Store and retrieve hiring velocity metrics, stage duration patterns, and email template performance data to improve personalization and reporting over time."
      },
      {
        "event_type": "user_message",
        "description": "Send status updates to the recruiting team about processing results, errors, or manual intervention needs."
      }
    ],
    "use_case_flows": [
      {
        "id": "flow_1",
        "name": "Candidate Stage Transition Processing",
        "description": "Core polling loop that detects Greenhouse stage changes, sends personalized emails, and posts Slack updates for each candidate transition.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Polling trigger fires",
            "detail": "Every 5 minutes, the agent wakes up to check for candidate updates"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Poll Greenhouse candidates",
            "detail": "GET /v1/candidates?updated_after={last_poll_ts}&per_page=100",
            "connector": "greenhouse"
          },
          {
            "id": "n3",
            "type": "action",
            "label": "Load local state",
            "detail": "Read recruiting_state.json to get candidate‚Üístage map and Slack thread map"
          },
          {
            "id": "n4",
            "type": "decision",
            "label": "Stage changed?",
            "detail": "Compare candidate's current Greenhouse stage against locally stored stage"
          },
          {
            "id": "n5",
            "type": "action",
            "label": "Classify transition type",
            "detail": "Determine type: application_received, interview, rejection, or offer based on stage name mapping"
          },
          {
            "id": "n6",
            "type": "decision",
            "label": "Is offer stage?",
            "detail": "Check if the transition is to an offer stage requiring manual approval"
          },
          {
            "id": "n7",
            "type": "event",
            "label": "Request manual review",
            "detail": "Emit manual_review event with drafted offer email for human approval before sending"
          },
          {
            "id": "n8",
            "type": "connector",
            "label": "Send personalized email",
            "detail": "Use gmail_send with stage-appropriate template: acknowledgment, interview prep, or rejection",
            "connector": "google_workspace"
          },
          {
            "id": "n9",
            "type": "connector",
            "label": "Post Slack update",
            "detail": "POST /api/chat.postMessage with candidate first name + last initial, role, and new stage. Thread if existing.",
            "connector": "slack"
          },
          {
            "id": "n10",
            "type": "action",
            "label": "Update local state",
            "detail": "Write updated candidate‚Üístage mapping, Slack thread_ts, and last_poll_timestamp to recruiting_state.json"
          },
          {
            "id": "n11",
            "type": "end",
            "label": "Cycle complete",
            "detail": "All transitions processed, state saved, ready for next poll"
          },
          {
            "id": "n12",
            "type": "error",
            "label": "Handle API failure",
            "detail": "Log error, retry with backoff for 5xx/429, skip candidate on 404, alert on auth failures"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4"
          },
          {
            "id": "e4",
            "source": "n4",
            "target": "n5",
            "label": "Yes",
            "variant": "yes"
          },
          {
            "id": "e5",
            "source": "n4",
            "target": "n10",
            "label": "No change",
            "variant": "no"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7",
            "label": "Yes ‚Äî offer",
            "variant": "yes"
          },
          {
            "id": "e8",
            "source": "n6",
            "target": "n8",
            "label": "No ‚Äî other stage",
            "variant": "no"
          },
          {
            "id": "e9",
            "source": "n8",
            "target": "n9"
          },
          {
            "id": "e10",
            "source": "n7",
            "target": "n9"
          },
          {
            "id": "e11",
            "source": "n9",
            "target": "n10"
          },
          {
            "id": "e12",
            "source": "n10",
            "target": "n11"
          },
          {
            "id": "e13",
            "source": "n2",
            "target": "n12",
            "label": "API error",
            "variant": "error"
          },
          {
            "id": "e14",
            "source": "n12",
            "target": "n11",
            "variant": "error"
          }
        ]
      },
      {
        "id": "flow_2",
        "name": "Weekly Recruiting Funnel Report",
        "description": "Scheduled Monday morning workflow that compiles 7-day recruiting metrics from Greenhouse, calculates conversion rates and trends, and distributes the report via Slack and email.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Monday 9 AM schedule fires",
            "detail": "Weekly cron trigger activates the metrics compilation workflow"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Fetch 7-day candidate data",
            "detail": "GET /v1/candidates?updated_after={7_days_ago} with pagination to collect all recent activity",
            "connector": "greenhouse"
          },
          {
            "id": "n3",
            "type": "connector",
            "label": "Fetch job and stage data",
            "detail": "GET /v1/jobs and /v1/jobs/{id}/stages for each active job to map stage names to funnel positions",
            "connector": "greenhouse"
          },
          {
            "id": "n4",
            "type": "action",
            "label": "Calculate funnel metrics",
            "detail": "Compute: applications, screens, interviews, offers, acceptances, rejections, conversion rates, avg time-in-stage"
          },
          {
            "id": "n5",
            "type": "action",
            "label": "Load historical data",
            "detail": "Read metrics_history.json for previous weeks to calculate week-over-week trends and deltas"
          },
          {
            "id": "n6",
            "type": "action",
            "label": "Generate formatted report",
            "detail": "Build structured report with funnel visualization, conversion rates, WoW trends, and pipeline health assessment"
          },
          {
            "id": "n7",
            "type": "connector",
            "label": "Post report to Slack",
            "detail": "POST /api/chat.postMessage with rich block formatting to #hiring-updates channel",
            "connector": "slack"
          },
          {
            "id": "n8",
            "type": "connector",
            "label": "Email report to team",
            "detail": "Send HTML-formatted funnel report via gmail_send to recruiting team distribution list",
            "connector": "google_workspace"
          },
          {
            "id": "n9",
            "type": "action",
            "label": "Archive weekly snapshot",
            "detail": "Append this week's metrics to metrics_history.json for future trend analysis"
          },
          {
            "id": "n10",
            "type": "end",
            "label": "Report delivered",
            "detail": "Weekly metrics distributed to all channels and archived for historical tracking"
          },
          {
            "id": "n11",
            "type": "error",
            "label": "Handle data fetch failure",
            "detail": "If Greenhouse API fails, generate partial report from cached state and note incomplete data in the report"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4"
          },
          {
            "id": "e4",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e5",
            "source": "n5",
            "target": "n6"
          },
          {
            "id": "e6",
            "source": "n6",
            "target": "n7"
          },
          {
            "id": "e7",
            "source": "n7",
            "target": "n8"
          },
          {
            "id": "e8",
            "source": "n8",
            "target": "n9"
          },
          {
            "id": "e9",
            "source": "n9",
            "target": "n10"
          },
          {
            "id": "e10",
            "source": "n2",
            "target": "n11",
            "label": "API error",
            "variant": "error"
          },
          {
            "id": "e11",
            "source": "n11",
            "target": "n6",
            "variant": "error"
          }
        ]
      },
      {
        "id": "flow_3",
        "name": "Offer Approval and Dispatch",
        "description": "Manual review workflow triggered when a candidate reaches the offer stage. Drafts congratulations email, requests human approval, and dispatches or discards based on the review decision.",
        "nodes": [
          {
            "id": "n1",
            "type": "start",
            "label": "Offer stage detected",
            "detail": "Candidate transition processing identifies an offer-stage move from Flow 1"
          },
          {
            "id": "n2",
            "type": "connector",
            "label": "Fetch offer details",
            "detail": "GET /v1/candidates/{id} and GET /v1/offers?candidate_id={id} for offer context and compensation data",
            "connector": "greenhouse"
          },
          {
            "id": "n3",
            "type": "action",
            "label": "Draft offer email",
            "detail": "Compose personalized congratulations email with role title, start date expectations, and next steps. Do NOT include compensation details."
          },
          {
            "id": "n4",
            "type": "event",
            "label": "Submit for manual review",
            "detail": "Emit manual_review event with draft email content, candidate info, and role details for human approval"
          },
          {
            "id": "n5",
            "type": "decision",
            "label": "Approved?",
            "detail": "Human reviewer approves the offer email for sending, or rejects with feedback"
          },
          {
            "id": "n6",
            "type": "connector",
            "label": "Send offer email",
            "detail": "Use gmail_send to deliver the approved offer congratulations email to the candidate",
            "connector": "google_workspace"
          },
          {
            "id": "n7",
            "type": "connector",
            "label": "Post approval to Slack",
            "detail": "POST /api/chat.postMessage: '‚úÖ Offer email sent to [Candidate] for [Role]' with hiring manager mention",
            "connector": "slack"
          },
          {
            "id": "n8",
            "type": "action",
            "label": "Log rejection reason",
            "detail": "Record the reviewer's rejection reason and discard the draft email. Log to state file for audit."
          },
          {
            "id": "n9",
            "type": "end",
            "label": "Offer flow complete",
            "detail": "Email sent and team notified, or draft discarded with reason logged"
          }
        ],
        "edges": [
          {
            "id": "e1",
            "source": "n1",
            "target": "n2"
          },
          {
            "id": "e2",
            "source": "n2",
            "target": "n3"
          },
          {
            "id": "e3",
            "source": "n3",
            "target": "n4"
          },
          {
            "id": "e4",
            "source": "n4",
            "target": "n5"
          },
          {
            "id": "e5",
            "source": "n5",
            "target": "n6",
            "label": "Approved",
            "variant": "yes"
          },
          {
            "id": "e6",
            "source": "n5",
            "target": "n8",
            "label": "Rejected",
            "variant": "no"
          },
          {
            "id": "e7",
            "source": "n6",
            "target": "n7"
          },
          {
            "id": "e8",
            "source": "n7",
            "target": "n9"
          },
          {
            "id": "e9",
            "source": "n8",
            "target": "n9"
          }
        ]
      }
    ]
  }
}
